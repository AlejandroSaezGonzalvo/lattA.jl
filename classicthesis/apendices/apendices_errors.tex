%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Error analysis}
\label{appex_errors}

In this Appendix we describe the methods employed for the data analysis of
observables extracted
from the lattice QCD Monte Carlo simulations.

As described in Appendix~\ref{appex_simulations}, lattice data stems from a Markov chain Monte Carlo process. Expectation values of physical observables are defined in terms of functions depending on estimators of primary observables, obtained by averaging over measurements performed on the gauge field configurations of the Markov chain. A central aspect of the analysis is to properly take into account the statistical correlations and autocorrelations present in the lattice data, and to estimate the various sources of systematic uncertainties. As discussed in a previous section, autocorrelations arise from the fact that in a Markov chain, any subsequent configuration is obtained from the previous one. A popular method to deal with autocorrelations consists in binning the elements of the Markov chain, in combination with resampling methods such as bootstrap or the jack-knife.

The analysis of the observables considered in this work is based on the $\Gamma$-method~\citep{Wolff:2003sm,Schaefer:2010hu,Ramos:2018vgu}, which explicitly computes the autocorrelation function to estimate the statistical uncertainty.

In a lattice calculation, one considers a primary observable $p_i$ determined on a set of ensembles (charaterized by the simulation parameters such as the inverse coupling $\beta$ and $\kappa$ parameter) 
\begin{equation}
p_i^{\alpha}(k), k=1,...,N_{\alpha},
\end{equation}
where $\alpha$ labels the ensemble and $k$ is the MC time spanning the total number of gauge configurations $N_{\alpha}$ of the given ensemble. Specifically, the primary observable can correspond to  a correlation function at a given Euclidean time. An unbiased estimator of the true value $P_i^{\alpha}$ is given by the mean value
\begin{equation}
\bar{p}_i^{\alpha}=\frac{1}{N_{\alpha}}\sum_{k=1}^{N_{\alpha}}p_i^{\alpha}(k)\xrightarrow[N_{\alpha}\rightarrow\infty]{}P_i^{\alpha}.
\end{equation}
Fluctuations over the MC time can be computed as
\begin{equation}
\delta_i^{\alpha}(k)=p_i^{\alpha}(k)-\bar{p}_i^{\alpha}.
\end{equation}
The Central Limit theorem ensures that the distribution of $\bar{p}_i^{\alpha}$ converges to a Gaussian distribution independently of the distribution of $p_i^{\alpha}(k)$, and so the statistical uncertainty associated to $\bar{p}_i^{\alpha}$ is given by the standard deviation $\sigma_i^{\alpha}$,
\begin{equation}
P_i^{\alpha}\approx\bar{p}_i^{\alpha}\pm\sigma_i^{\alpha}.
\end{equation}
This standard deviation can be computed from the autocorrelation $\Gamma$ function
\begin{equation}
(\sigma_i^{\alpha})^2=\frac{1}{N_{\alpha}}\sum_{k=-\infty}^{\infty}\Gamma_{ii}^{\alpha\alpha}(k),
\end{equation}
where the $\Gamma$ function is defined as
\begin{equation}
\Gamma_{ij}^{\alpha\beta}(k)=\frac{\delta_{\alpha\beta}}{N_{\alpha}-k}\sum_{k'=1}^{N_{\alpha}-k}\delta_i^{\alpha}(k+k')\delta_j^{\alpha}(k').
\end{equation}

From the primary observable $P_i^{\alpha}$ we can compute derived observables $F=f(P_i^{\alpha})$, such as meson masses coming from pseudoscalar two point functions. An estimator of the derived observable can be written as follows
\begin{equation}
\bar{F}=f(\bar{p}_i^{\alpha}).
\end{equation}
To compute the statistical uncertainty, we can expand $f$ around the true value $P_i^{\alpha}$
\begin{equation}
f(P_{i}^{\alpha}+\epsilon_{i}^{\alpha})=f(P_{i}^{\alpha})+\bar{f}_i^{\alpha}\epsilon_{i}^{\alpha}+\mathcal{O}((\epsilon_{i}^{\alpha})^2),
\end{equation}
with
\begin{equation}
\bar{f}_i^{\alpha}=\left.\frac{\partial f(x)}{\partial x}\right|_{x=P_{i}^{\alpha}}.
\end{equation}
It follows that the autocorrelation function of the derived observable $F$ for ensemble $\alpha$ can be defined as
\begin{equation}
\Gamma_F^{\alpha}(k)=\sum_{ij}\bar{f}_i^{\alpha}\bar{f}_j^{\alpha}\Gamma_{ij}^{\alpha\alpha}(k),
\end{equation}
from which the standard deviation of $F$ can be derived
\begin{equation}
\sigma_F^2=\sum_{\alpha}\frac{\Gamma_F^{\alpha}(0)}{N_{\alpha}}2\tau_{\textrm{int}}^{\alpha}(F),
\end{equation}
where the sum $\sum_{\alpha}$ is over the subset of ensembles contributing to $F$. The integrated autocorrelation time $\tau_{\textrm{int}}^{\alpha}(F)$ is defined as
\begin{equation}
\label{app_errors:eq:taui}
\tau_{\textrm{int}}^{\alpha}(F)=\frac{1}{2}+\sum_{k=1}^{\infty}\frac{\Gamma_F^{\alpha}(k)}{\Gamma_F^{\alpha}(0)}.
\end{equation}
To estimate it, a truncation in the sum over the index $k$, spanning over the separations in MC time, is needed. The autocorrelation function admits the following expansion~\citep{Luscher:2011kk,Schaefer:2010hu}
\begin{equation}
\Gamma(k)\approx\sum_{n=0}^{\infty}a_ne^{-k/\tau_n}.
\end{equation}
The slowest mode $\tau_0\equiv\tau_{\textrm{exp}}$ is called the exponential autocorrelation time and it gives the asymptotic decay rate of $\Gamma(k)$. Truncating eq.~(\ref{app_errors:eq:taui}) at a MC time separation $k=W_F^{\alpha}$ introduces an estimated systematic uncertainty of $\mathcal{O}(\exp(-W_F^{\alpha}/\tau_{\textrm{exp}}^{\alpha}))$. The $\Gamma$-method proposes as optimal window that which minimizes the sum of statistical (estimated in~\citep{Madras:1988ei}) and systematic contributions
\begin{equation}
W_F^{\alpha}=\textrm{min}_W\left(\sqrt{\frac{2(2W+1)}{N_{\alpha}}}+e^{-W/\tau_{\textrm{exp}}^{\alpha}}\right).
\end{equation}
In~\citep{Wolff:2003sm} it was proposed to use $\tau_{\textrm{exp}}=S_{\tau}\tau_{\textrm{int}}$, with $S_{\tau}$ some value between 2 and 5. One can also vary $W_F^{\alpha}$ until observing a stability regime of $\tau_{\textrm{int}}^{\alpha}$. Finally, it was also proposed to add an exponential tail~\citep{Schaefer:2010hu}
\begin{equation}
\tau_{\textrm{exp}}^{\alpha}\frac{\Gamma_F^{\alpha}(W_F^{\alpha}+1)}{\Gamma_F^{\alpha}(0)},
\end{equation}
to eq.~(\ref{app_errors:eq:taui}) to account for the systematic effect of truncating the sum over MC time. An estimate of $\tau_{\textrm{exp}}^{\alpha}$ is needed for each ensemble. In the case of CLS ensembles the following estimate has been considered~\citep{Bruno:2014jqa}
\begin{equation}
\tau_{\textrm{exp}}^{\alpha}=14(3)\frac{t_0}{a^2}.
\end{equation}

In this work we have used the $\Gamma$-method explained above as implemented in the ADerrors.jl julia package~\citep{Ramos:2020scv}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

