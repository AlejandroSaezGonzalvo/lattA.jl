\chapter{QCD on the lattice}%\addcontentsline{toc}{chapter}{QCD on the lattice}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\label{ch_foundation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}
\label{ch_foundation:sec:general}

The gauge theory that describes the strong interaction between quarks and gluons is called Quantum Chromodynamics or QCD. 

The underlying symmetry of QCD is associated with the non-abelian $SU(N=3)$ Lie group. The elements of this group are non-commuting, unitary matrices $\Omega$ with unit determinant $\textrm{det}\;\Omega=1$. When considering a gauge theory the group elements must depend on space-time coordinates. The map
\begin{equation}
\Omega(x)=e^{i\alpha^{(a)}(x)T^{(a)}},
\end{equation}
provides a local parameterization of the group elements connected to the identity with coordinates $\alpha^{(a)}(x)$. Summation over $a=1,...,N^2-1=8$ is implicit and $T^{(a)}$ are the 8 generators of the $SU(3)$ Lie group. These live in the Lie algebra $su(3)$, which is the tangent space of the group $SU(3)$ at the identity $I\in SU(3)$. They satisfy the commutation relations
\begin{equation}
\left[T^{(a)}, T^{(b)}\right]=if_{abc}T^{(c)},
\end{equation}
where $f_{abc}$ are the structure constants of the group, given in Appendix~\ref{apex_SU3}. The unitarity of the elements of the group is written as follows
\begin{equation}
\Omega^{\dagger}\Omega=1.
\end{equation}

The group elements $\Omega$ must be in some representation which determines how they act on a vector space where the degrees of freedom of the theory live. In QCD these are quarks and gluons. The former are described by spinor fields $\psi_{\alpha,i},\bar{\psi}_{\alpha,i}$. They carry a Dirac spinor index $\alpha=1,2,3,4$ and a flavor index $i=1,...,N_f$, to each flavor corresponding a different mass (in Nature $N_f=6$). They transform under SU(3) in the fundamental representation,
\begin{gather}
\psi(x)\to\Omega(x)\psi(x), \quad \bar{\psi}(x)\to\bar{\psi}(x)\Omega(x)^{\dagger}.
\end{gather}
In this representation the group generators $T^{(a)}$ are given by the Gell-Mann matrices (see Appendix~\ref{apex_SU3}), and quark fields live in a 3-dimensional vector space, and therefore have an additional index $c=1,2,3$ referred to as color. As spinor fields, their dynamics is governed by the Dirac fermionic action, which in Euclidean metric $g_{\mu\nu}=\textrm{diag}(+1,+1,+1,+1)$ reads
\begin{equation}
S_{\textrm{F}}=\sum_{i=1}^{N_f}\int d^4x\;\bar{\psi}^{i}(x)\left(\gamma_{\mu}\partial_{\mu}+m_i\right)\psi^i(x).
\end{equation} 
Here we have implicitly summed over the repeated $\mu$ index and omitted the spinor and color indices. This action is invariant under global $SU(3)$ transformations ($\Omega$ independent of $x$). In order to promote this transformation into a local or gauge symmetry, we must replace the derivative by a covariant derivative
\begin{equation}
\partial_{\mu}\psi(x)\to D_{\mu}\psi(x)=\partial_{\mu}\psi(x)+iA_{\mu}(x)\psi(x),
\end{equation}
with $A_{\mu}$ a new gauge field which must transform under $SU(3)$ in the adjoint representation
\begin{equation}
\label{ch_foundation:eq:Agauge}
A_{\mu}(x)\to\Omega(x)A_{\mu}(x)\Omega^{\dagger}(x)+i\Omega(x)\partial_{\mu}\Omega^{\dagger}(x),
\end{equation}
in order to ensure gauge invariance of the Dirac action. This field $A_{\mu}$ lives in the $su(3)$ algebra, and thus it is a hermitian, traceless matrix which can be decomposed as a linear combination of the generators $T^{(a)}$
\begin{equation}
A_{\mu}=A_{\mu}^{(a)}T^{(a)},
\end{equation}
where we again implicitly sum over the repeated index $a$. The gauge or gluon fields must have a kinetic piece in the action for them to be dynamical fields. This is given by the Yang-Mills action
\begin{equation}
\label{ch_foundation:eq:SYM}
\frac{1}{2g_0^2}\int d^4x\;\textrm{tr}(F_{\mu\nu}(x)F_{\mu\nu}(x)),
\end{equation}
which describes dynamical gauge fields in the absence of matter fields. The dimensionless parameter $g_0$ is the bare coupling constant and the energy strength tensor $F_{\mu\nu}$ is given by
\begin{align}
F_{\mu\nu}(x)&=\partial_{\mu}A_{\nu}(x)-\partial_{\nu}A_{\mu}(x)+i\left[A_{\mu}(x),A_{\nu}(x)\right].
\end{align}
It lives in the $su(3)$ algebra and can be expressed as
\begin{equation}
F_{\mu\nu}=F_{\mu\nu}^{(a)}T^{(a)}.
\end{equation}
From the transformation in eq.~(\ref{ch_foundation:eq:Agauge}) we derive the gauge transformation relations of $F_{\mu\nu}$
\begin{align}
F_{\mu\nu}(x)&\to\Omega(x)F_{\mu\nu}(x)\Omega^{\dagger}(x).
\end{align}

By collecting the various elements, the continuum QCD action can thus be written as follows
\begin{align}
\label{ch_foundation:eq:QCD}
S_{\textrm{QCD}}&=\sum_{i=1}^{N_f}\int d^4x\;\bar{\psi}^i(x)\left(\gamma_{\mu}D_{\mu}+m_i\right)\psi^i(x) \\
&+\frac{1}{2g_0^2}\int d^4x\;{\textrm{tr}}\left(F_{\mu\nu}(x)F_{\mu\nu}(x)\right).
\end{align}
The only parameters of this action are the quark masses $m_i$ and the dimensionless coupling constant $g_0$.

As mentioned in the Introduction, QCD is a strongly coupled theory at low energies or large distances. In this regime, perturbation theory cannot be applied to calculate physical observables, since an expansion in powers of the coupling does not converge. The only known first-principles method to carry out non-perturbative calculations of a Quantum Field Theory is Lattice Quantum Field Theory.  For the specific case of Quantum Chromodynamics, we will consider a Lattice QCD formulation. This method is based on the discretization of space-time into a hypercubic box or lattice
\begin{equation}
\Lambda=\{n_0,n_1,n_2,n_3|n_0=0,...,T/a-1;n_i=0,...,L/a-1;i=1,2,3\},
\end{equation} 
where $a$ is the lattice spacing between two adjacent sites, and $L,T$ are the spatial and temporal lattice extents (in physical units) respectively. The discretization of space-time and the introduction of a finite lattice spacing $a$ provide a natural momentum cutoff $\sim a^{-1}$, regularizing UV divergences. Similarly, the finite lattice extent can be interpreted as in IR cutoff. This implies that the lattice formulation can be seen as a way to regularize any particular Quantum Field Theory. However, the presence of these cutoffs induces discretization and finite volume effects that must be removed from any physical observable. This procedure can be accomplished by defining a line of constant physics in which all parameters, corresponding to the renormalized quark masses, the renormalized coupling and the volume, are kept constant while the lattice spacing $a$ is reduced towards the continuum limit, $a\rightarrow0$. Finite volume corrections to these continuum results can then be studied -- e.g. through dedicated lattice simulations or through effective field theories -- to extrapolate the results to the  infinite volume limit. For a renormalizable theory such as QCD,  the extrapolation to the  continuum limit of the lattice  formulation allows to obtain finite results for physical observables, after having renormalized the bare parameters of the Lagrangian.

After discretizing space-time, fermion fields are located at the lattice sites $n\in\Lambda$
\begin{gather}
\psi(n),\bar{\psi}(n), \quad
n\in\Lambda.
\end{gather}
For the gauge fields, it will be helpful to use the definition of a parallel transporter for $SU(N)$. An $N$-component unit vector $\boldsymbol{v}$ is parallel transported along a curve in space-time parameterized by $z_{\mu}(t)$ from point $z_{\mu}(a)=x$ to $z_{\mu}(b)=y$ as
\begin{align}
\boldsymbol{v}(b)&=P(y,x)\boldsymbol{v}(a),\\
P(y,x)&=\mathcal{P}e^{i\int_x^yA_{\mu}(z)dz_{\mu}},
\end{align}
with $A_{\mu}$ the $SU(N)$ gauge field. This implies that a fermion in the fundamental representation acquires a phase factor of $P(y,x)$ when going from $x$ to $y$. This parallel transporter is referred to as a gauge link and its discrete version will be used for the gauge degrees of freedom on the lattice. It is an element of the group and transforms as
\begin{equation}
P(x,y)\to\Omega(x)P(x,y)\Omega^{\dagger}(y).
\end{equation}

Once the fields have been defined on the lattice, the next step is to discretize the QCD action. This is done by formulating it in a finite box $\Lambda$ in terms of the aforementioned fields in such a way that in the continuum limit $a\rightarrow 0$ the continuum QCD action is recovered. We discuss this in the following sections.	

The Chapter is organized as follows. In Sec.~\ref{ch_foundation:sec:Gauge} we present the Wilson formulation of the gauge action on the lattice, expressed in terms of the link variables. In Sec.~\ref{ch_foundation:sec:Fermions} we present various methods for discretizing the fermion action. In Sec.~\ref{ch_foundation:subsec:Naive} we discuss the issue of fermion doublers that arise with a naive fermion discretization and its connection to the formulation of chiral symmetry on the lattice. We also provide some brief comments on Ginsparg-Wilson fermions. In Sec.~\ref{ch_foundation:subsec:Wilson} we present the solution to the doublers problem proposed by Wilson, which consists in adding a term that explicitly breaks chiral symmetry. This term gives an additional mass to the doublers that grows with the inverse of the lattice spacing $a$, thus decoupling in the continuum limit and helping to distinguish them from the true pole. In Sec.~\ref{ch_foundation:subsec:tm} we discuss a modification of Wilson fermions which adds a chirally rotated mass term. This regularization offers several features that will be exploited in our work. In Sec.~\ref{ch_foundation:sec:path} we review some of the fundamental concepts of the path integral formalism and how expectation values are computed numerically on the lattice. In Sec.~\ref{ch_foundation:sec:continuum-limit} we review some concepts of renormalizability and the continuum limit on the lattice. In Sec.~\ref{ch_foundation:sec:impr} we discuss the Symanzik improvement program, which allows to systematically subtract cutoff effects associated with the lattice action and fields, thus facilitating the task of performing the continuum limit. Finally, in Sec.~\ref{ch_foundation:sec:ss} the procedure for setting the scale on the lattice is discussed. This is a necessary step of the lattice calculation that allows to obtain  predictions in physical units.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Pure gauge SU(3) theory on the lattice}
\label{ch_foundation:sec:Gauge}

On the lattice, gluon fields can be defined by the link variables $U_{\mu}(x)\in SU(3)$ that act as a discrete version of the gauge transporters connecting points $x$ and $x+\hat{\mu}$, with $\hat{\mu}=\{\hat{x}_0,\hat{x}_1,\hat{x}_2,\hat{x}_3\}$
\begin{equation}
\label{ch_foundation:eq:U}
U_{\mu}(x)=\exp\left(iaA_{\mu}(x)\right).
\end{equation}
These fields transform as 
\begin{equation}
\label{ch_foundation:eq:U_transf}
U_{\mu}(x)\to\Omega(x)U_{\mu}(x)\Omega^{\dagger}(x+\hat{\mu}),
\end{equation}
and they live on the links of the lattice that connect sites $x$ and $x+\hat{\mu}$.

A common discretization of the gluonic action is the Wilson gauge action~\citep{Wilson:1974sk}, which is expressed in terms of the link variables $U_{\mu}(x)$
\begin{equation}
\label{ch_foundation:eq:SG}
S_{\textrm{G}}=\frac{1}{g_0^2}\sum_x\sum_{\mu,\nu}{\textrm{Re\; tr}}\left(1-U_{\mu\nu}(x)\right),
\end{equation} 
where $U_{\mu\nu}(x)$ is the plaquette centered on the lattice site $x$
\begin{equation}
\label{ch_foundation:eq:plaq}
U_{\mu\nu}(x)=U_{\mu}(x)U_{\nu}(x+\hat{\mu})U_{\mu}^{\dagger}(x+\hat{\nu})U_{\nu}^{\dagger}(x),
\end{equation}
Using the Baker-Campbell-Hausdorff formula iteratively
\begin{equation}
\exp\left(A\right)\exp\left(B\right)=\exp\left(A+B+\frac{1}{2}\left[A,B\right]+...\right),
\end{equation}
and using eq.~(\ref{ch_foundation:eq:U}) we arrive at
\begin{equation}
\label{ch_foundation:eq:YM-latt}
S_{\textrm{G}}=a^4\frac{\beta}{6}\sum_x\sum_{\mu,\nu}{\textrm{tr}}\left(F_{\mu\nu}^2(x)\right)+\mathcal{O}(a^2),
\end{equation}
where we introduced the inverse coupling
\begin{equation}
\beta=\frac{6}{g_0^2}.
\end{equation}
By taking the continuum limit, and in particular using $a^4\sum_x\rightarrow\int d^4x$, we recover the continuum Yang-Mills action.

Eq.~(\ref{ch_foundation:eq:YM-latt}) shows that the effects associated with the discretization of space-time are of order $\mathcal{O}(a^2)$ for the Wilson gauge action. The discretization of the SU(3) pure Yang-Mills action is not unique, and different choices result in different cutoff effects.

The $\mathcal{O}(a^2)$ cutoff effects present in the Wilson regularization of the gauge action can be further reduced by adding additional terms that respect the symmetries of the theory following the Symanzik improvement program. One such choice is the Lüscher-Weisz action~\citep{Luscher:1984xn}, which we discuss in Sec.~\ref{ch_foundation:sec:impr}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Introducing fermions on the lattice}
\label{ch_foundation:sec:Fermions}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

After discretizing the SU(3) gauge action, we still need to find a suitable discrete version of the fermion action in eq.~(\ref{ch_foundation:eq:QCD}) to fully formulate QCD on the lattice. Theoretical challenges arise when considering a naive fermion discretization and we will describe how these can be addressed with alternative formulations.

\subsection{Naive fermions}
\label{ch_foundation:subsec:Naive}

To discretize the continuum fermion action in the absence of gauge fields, considering only one flavor with mass $m$,
\begin{equation}
S_{\textrm{F}}=\int d^4x\bar{\psi}(x)\left(\gamma_{\mu}\partial_{\mu}+m\right)\psi(x),
\end{equation}
the derivative $\partial_{\mu}$ takes a discrete form such as
\begin{equation}
\partial_{\mu}\psi(x)\rightarrow\hat{\partial}_{\mu}\psi(x)=\frac{1}{2a}\left(\psi(x+\hat{\mu})-\psi(x-\hat{\mu})\right).
\end{equation}
In order to preserve the gauge symmetry of the action, the derivative must be promoted to a covariant derivative, as in the case of the continuum formulation. To this end, we note that terms such as
\begin{equation}
\bar{\psi}(x)\psi(x+\hat{\mu}),
\end{equation}
which arise from $\bar{\psi}(x)\hat{\partial}_{\mu}\psi(x)$, are not gauge invariant
\begin{equation}
\bar{\psi}(x)\psi(x+\hat{\mu})\to\bar{\psi}(x)\Omega^{\dagger}(x)\Omega(x+\hat{\mu})\psi(x+\hat{\mu}).
\end{equation}
The solution is to introduce the link variable or parallel transporter $U_{\mu}(x)$ from site $x$ to $x+\hat{\mu}$ defined in eq.~(\ref{ch_foundation:eq:U}) which transforms as in eq.~(\ref{ch_foundation:eq:U_transf}). Thus, the discretized fermion action reads
\begin{equation}
\label{ch_foundation:eq:naive}
S_{\textrm{F}}=a^4\sum_x\bar{\psi}(x)\left(\gamma_{\mu}\frac{U_{\mu}(x)\psi(x+\hat{\mu})-U_{\mu}^{\dagger}(x-\hat{\mu})\psi(x-\hat{\mu})}{2a}+m\psi(x)\right).
\end{equation}

However, this naive formulation of the fermion action exhibits the doubling problem: despite the fact that we wrote our action to describe one fermion of mass $m$, at finite lattice spacing $a$ additional unphysical poles appear. These additional flavor species are known as doublers. To see how they appear, we consider the massive Dirac operator $D$ in the continuum, defined such that
\begin{equation}
S_{\textrm{F}}=\int d^4x\;\bar{\psi}(x)D\psi(x).
\end{equation}
On the lattice this takes the form
\begin{equation}
S_{\textrm{F}}=a^4\sum_{n,m}\bar{\psi}(n)D(n,m)\psi(m),
\end{equation}
with the Dirac operator for the naive fermion formulation given by
\begin{equation}
D(n,m)=\gamma_{\mu}\frac{U_{\mu}(n)\delta_{n+\hat{\mu},m}-U_{\mu}^{\dagger}(n-\hat{\mu})\delta_{n-\hat{\mu},m}}{2a}+m\delta_{n,m}.
\end{equation}
Considering the free theory, $U_{\mu}=1$, for a massless fermion, $m=0$, upon Fourier transform we get
\begin{align}
\tilde{D}(p,q)&=\frac{1}{V}\sum_{n,m}e^{-ip\times na}D(n,m)e^{iq\times ma}\\
&=\frac{1}{V}\sum_{n,m}e^{-i(p-q)na}\left(\gamma_{\mu}\frac{e^{iq_{\mu}a}-e^{-iq_{\mu}a}}{2a}\right)\\
&=\delta(p-q)\tilde{D}(p),
\end{align}
with $V$ the 4-dimensional volume of the lattice and
\begin{equation}
\tilde{D}(p)=\sum_{\mu}\frac{i}{a}\gamma_{\mu}\textrm{sin}(p_{\mu}a),
\end{equation}
where we made explicit again the sum over $\mu$. The inverse of this operator can be computed as
\begin{equation}
\label{ch_foundations:eq:Dinv}
\tilde{D}^{-1}(p)=-\frac{ia^{-1}\sum_{\mu}\gamma_{\mu}\sin(p_{\mu}a)}{a^{-2}\sum_{\mu}\sin(p_{\mu}a)^2}.
\end{equation}
We can see that in the continuum $a\rightarrow0$ we recover the correct form of the Dirac operator
\begin{equation}
\tilde{D}(p)^{-1}|_{m=0}\rightarrow\frac{-i\gamma_{\mu}p_{\mu}}{p^2}
\end{equation}
with one single pole at $p^2=0$. However, at finite lattice spacing, the denominator in eq.~(\ref{ch_foundations:eq:Dinv}) vanishes not only for $p=(0,0,0,0)$ but also for 
\begin{equation}
p=(\pi/a,0,0,0),\;(0,\pi/a,0,0),\;...,\;(\pi/a,\pi/a,\pi/a,\pi/a).
\end{equation}
These 15 unwanted poles are called doublers, and they affect the dynamics of the theory. 

The problem of doublers is related to chiral symmetry and its implementation on the lattice. Chiral symmetry in continuum QCD can be expressed as 
\begin{equation}
\label{ch_foundation:eq:chirality}
\{D,\gamma_5\}=0,
\end{equation}
with $D$ the Dirac operator. The Nielsen-Ninomiya~\citep{Nielsen:1980rz,Nielsen:1981hk} Theorem states that one cannot implement chiral symmetry in the way of eq.~(\ref{ch_foundation:eq:chirality}) on the lattice without the appearance of doublers. Ginsparg and Wilson~\citep{Ginsparg:1981bj} proposed a suitable version of chiral symmetry on the lattice as
\begin{equation}
\label{ch_foundation:eq:chirality-latt}
\{D,\gamma_5\}=aD\gamma_5D,
\end{equation}
such that in the continuum eq.~(\ref{ch_foundation:eq:chirality}) is recovered. With this definition of chiral symmetry on the lattice, it is possible to construct Dirac operators that satisfy eq.~(\ref{ch_foundation:eq:chirality-latt}) and that is free of doublers. 

An alternative approach is to build a Dirac operator that explicitly breaks chiral symmetry in eq.~(\ref{ch_foundation:eq:chirality}) but removes the doublers. Wilson fermions and Wilson twisted mass fermions are examples of such a choice, which we will consider in the following.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Wilson fermions}
\label{ch_foundation:subsec:Wilson}

Wilson proposed~\citep{Wilson:1974sk} to add an extra term to the naive fermion action in eq.~\eqref{ch_foundation:eq:naive} to distinguish the doublers from the physical pole. The Wilson fermion action reads
\begin{equation}
\label{ch_foundation:eq:Wil_fer}
S_{\textrm{W}}=a^4\sum_x\bar{\psi}(x)\frac{1}{2}\left(\gamma_{\mu}\left(\nabla_{\mu}+\nabla_{\mu}^*\right)+2m-a\nabla_{\mu}\nabla_{\mu}^*\right)\psi(x),
\end{equation}
where we have defined the forward and backward discrete covariant derivatives as
\begin{align}
\nabla_{\mu}\psi(x)&=\frac{U_{\mu}(x)\psi(x+\hat{\mu})-\psi(x)}{a},\\
\nabla_{\mu}^*\psi(x)&=\frac{\psi(x)-U_{\mu}^{\dagger}(x-\hat{\mu})\psi(x-\hat{\mu})}{a}.
\end{align}
From the expression of Wilson fermion action in eq.~\eqref{ch_foundation:eq:Wil_fer}, it follows that the Wilson Dirac operator reads
\begin{equation}
\label{ch_foundation:eq:DW}
D=D_{\textrm{W}}+m=\frac{1}{2}\left(\gamma_{\mu}\left(\nabla_{\mu}+\nabla_{\mu}^*\right)-a\nabla_{\mu}\nabla_{\mu}^*\right)+m,
\end{equation}
where we have introduced the massless Wilson Dirac operator $D_{\textrm{W}}$, and the action can be written as
\begin{equation}
S_{\textrm{W}}=a^4\sum_x\bar{\psi}(x)\left(D_{\textrm{W}}+m\right)\psi(x).
\end{equation}
For $N_f$ flavors, an additional sum over a flavor index $i=1,...,N_f$ is required, and $m$ is promoted to a diagonal matrix in flavor space, whose diagonal elements are $m_i$. The fermion mass $m_i$ is commonly expressed in terms of the hopping parameter $\kappa$
\begin{equation}
\label{ch_foundation:eq:kappa}
\kappa_i=\frac{1}{2am_i+8}.
\end{equation}
For the free case, the momentum space massless Dirac operator reads
\begin{equation}
\tilde{D}_{\textrm{W}}(p)=\frac{i}{a}\sum_{\mu}\gamma_{\mu}\textrm{sin}(p_{\mu}a)+\frac{1}{a}\sum_{\mu}\left(1-\textrm{cos}(p_{\mu}a)\right).
\end{equation}
The second summand in the right-hand side comes from the added Wilson term $a\nabla_{\mu}\nabla_{\mu}^*$ in the action, which is responsible for giving an additional mass term to the doublers
\begin{equation}
\frac{2l}{a},
\end{equation}
where $l$ is the number of momentum components with $p_{\mu}=\pi/a$. This additional mass term separates the doublers from the physical pole and causes them to decouple as we approach the continuum limit.

The Wilson term $a\nabla_{\mu}\nabla_{\mu}^*$ in the Wilson Dirac operator manifestly breaks chiral symmetry, even in the $m_i=0$ limit. Chiral symmetry is however restored in the continuum limit. Consequently, the quark mass receives an additive renormalization contribution, 
\begin{equation}
m_i^{\textrm{R}}=Z_m\left(m_i-m_{\textrm{cr}}\right),
\end{equation}
since it is no longer protected against such a contribution by the axial symmetry.

The Wilson fermion action receives leading cutoff effects of $\mathcal{O}(a)$ cutoff effects, which can be systematically eliminated by using the Symanzik improvement program detailed in Sec.~\ref{ch_foundation:sec:impr}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Wilson twisted mass fermions}
\label{ch_foundation:subsec:tm}

Wilson twisted mass (tm) fermions~\citep{Frezzotti:1999vv,Frezzotti:2000nk,Frezzotti:2001ea,Frezzotti:2003ni,Shindler:2007vp} introduce an imaginary mass term to the Wilson Dirac operator in eq.~\eqref{ch_foundation:eq:DW} of the form
\begin{equation}
i\bar{\psi}(x)\boldsymbol{\mu}\gamma_5\psi(x),
\end{equation}
with $\boldsymbol{\mu}$ the twisted quark mass matrix in flavor space. More specifically, the Wilson tm Dirac operator reads
\begin{equation}
D=D_{\textrm{W}}+\boldsymbol{m}+i\boldsymbol{\mu}\gamma_5.
\end{equation}
We consider four quark flavors
\begin{align}
\boldsymbol{\mu}&={\textrm{diag}}\left(\mu_u,-\mu_d,-\mu_s,\mu_c\right), \\
\boldsymbol{m}&={\textrm{diag}}\left(m_u,m_d,m_s,m_c\right).
\end{align}
By rotating the fields
\begin{gather}
\label{ch_foundation:eq:chiral_rot}
\psi~\to~\psi' = e^{-i\frac{\pi}{2}\gamma_5 \frac{T}{2}}\psi, \quad
\bar{\psi}~\to~\bar{\psi}' = \bar{\psi} e^{-i\frac{\pi}{2}\gamma_5 \frac{T}{2}}, \quad \\
T = {\textrm{diag}}(\eta_u,\eta_d,\eta_s,\eta_c),
\end{gather}
with $\alpha_i\equiv\frac{\pi}{2}\eta_i$ the so-called twist angles,
one retrieves the usual physical (standard) formulation with real fermionic mass
\begin{equation}
M_i=\sqrt{m_i^2+\mu_i^2},
\end{equation}
and a chirally rotated Wilson term. The twist angles can be defined in the renormalized theory in terms of the ratio of the renormalized standard and twisted quark masses as
\begin{equation}
{\textrm{cot}}\;\alpha_i=\frac{m_i^{\textrm{R}}}{\mu_i^{\textrm{R}}}.
\end{equation}
The rotated fields $\psi',\bar{\psi}'$ define the so-called physical basis, while the unrotated ones $\psi,\bar{\psi}$ define the twisted basis.

In practice we will be working with Wilson tm fermions at maximal twist
\begin{equation}
\label{ch_foundation:eq:mte}
\eta_u=\eta_c=-\eta_s=-\eta_d=1,
\end{equation}
which can be obtained by setting the renormalized standard masses $m_i^{\textrm{R}}$ to zero. The procedure to achieve this is explained in Sec.~\ref{ch_ma:sec:matching}.

Considering for simplicity the light sector of mass-degenerate light up/down ($u$ and $d$) quarks, at maximal twist the symmetry group $SU(2)_V\times SU(2)_A$ is broken into
\begin{equation}
SU(2)_V\times SU(2)_A\rightarrow[U(1)_A]_1\times[U(1)_A]_2\times[U(1)_V]_3,
\end{equation}
with 
\begin{align}
\left[U(1)_A\right]_a=\left\{\begin{matrix}
\psi(x)\rightarrow e^{i\alpha_A^a\gamma_5\frac{\tau^a}{2}}\psi(x) & a=1,2 \\ 
\bar{\psi}(x)\rightarrow \bar{\psi}(x)e^{i\alpha_A^a\gamma_5\frac{\tau^a}{2}} & a=1,2
\end{matrix}\right.,
\end{align}
and
\begin{equation}
\left[U(1)_V\right]_3=\left\{\begin{matrix}
\psi(x)\rightarrow e^{i\alpha_A^3\frac{\tau^3}{2}}\psi(x) \\ 
\bar{\psi}(x)\rightarrow \bar{\psi}(x)e^{-i\alpha_A^3\frac{\tau^3}{2}}
\end{matrix}\right.,
\end{equation}
with $\tau^{a}$ the Pauli matrices. This means that at maximal twist axial symmetries are not completely broken, and thus the twisted mass is protected against additive renormalization,
\begin{equation}
\label{ch_foundation:eq:muR}
\mu_i^{\textrm{R}}=Z_{\mu}(g_0^2,\mu_{\textrm{ren}})\mu_i,
\end{equation}
with $\mu_{\textrm{ren}}$ the renormalization scale.

The Ward-Takahashi identities (WTI) can be used to define the maximal twist condition in terms of a vanishing current quark mass. Furthermore, they allow the renormalization factor of the twisted mass $Z_{\mu}$ to be related to that of the pseudoscalar density $Z_P$. For the non-singlet case ($i\neq j$) the WTI for the axial and vector currents in the twisted basis, read (see eqs.~(\ref{ch_observables:eq:P}-\ref{ch_observables:eq:A}) for the definition of the currents)
\begin{align}
\label{ch_foundation:eq:WTI_V}
\partial_{\mu}V_{\mu}^{ij}&=(m_i-m_j)S^{ij}+i(\eta_i\mu_i-\eta_j\mu_j)P^{ij},\\
\label{ch_foundation:eq:WTI_A}
\partial_{\mu}A_{\mu}^{ij}&=(m_i+m_j)P^{ij}+i(\eta_i\mu_i+\eta_j\mu_j)S^{ij}.
\end{align}
Note that at zero twist angle $\eta_u=\eta_d=\eta_s=\eta_c=0$ the twisted and physical basis coincide, and the standard WTIs are recovered. On the other hand, at maximal twist the renormalized standard masses $m_i^{\textrm{R}}$ vanish, which in turn means that the current masses $m_{i}$ in eqs.~(\ref{ch_foundation:eq:WTI_V}-\ref{ch_foundation:eq:WTI_A}) also vanish. Moreover, the exact flavor symmetry of massless Wilson fermions implies the existence of a point-split vector current $\tilde{V}_{\mu}^{ij}$ on the lattice such that the vector WTI holds exactly. In the twisted basis, the conserved vector current thus takes the form
\begin{equation}
\label{ch_foundation:eq:V_split}
\tilde{V}_{\mu}^{ij}=\frac{1}{2}\left[\bar{\psi}^i(x)(\gamma_{\mu}-1)U_{\mu}(x)\psi^j(x+\hat{\mu})+\bar{\psi}^i(x+\hat{\mu})(\gamma_{\mu}+1)U_{\mu}^{\dagger}(x)\psi^j(x)\right].
\end{equation}
The conservation of this WTI on the lattice for $\tilde{V}_{\mu}^{ij}$ means that the point-split vector current renormalizes trivially with
\begin{equation}
\label{ch_foundation:eq:ZV=1}
Z_{\tilde{V}}=1.
\end{equation}
From eq.~(\ref{ch_foundation:eq:WTI_V}) this implies that for all flavors
\begin{equation}
\label{ch_foundation:eq:Zmu}
Z_{\mu}(g_0^2,\mu_{\textrm{ren}})=Z_P^{-1}(g_0^2,\mu_{\textrm{ren}}).
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Path integral formulation}
\label{ch_foundation:sec:path}

Having formulated the QCD action on the lattice, we need to see how physical quantities are computed. To do so, we review some aspects of the path integral formulation in Euclidean space-time. In this formalism, physical quantities are expressed as expectation values of operators
\begin{align}
\left<{O}(x_1,...,x_n)\right>&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[\psi,\bar{\psi},U]{O}(x_1,...,x_n)e^{-S[\psi,\bar{\psi},U]}, \\
\mathcal{Z}&=\int\mathcal{D}[\psi,\bar{\psi},U]e^{-S[\psi,\bar{\psi},U]}.
\end{align}
This is equivalent to expectation values in statistical mechanics with a Boltzmann factor of $e^{-S[\psi,\bar{\psi},U]}$. The action can be decomposed into its gluon and fermion components $S[\psi,\bar{\psi},U]=S_{\textrm G}[U]+S_{\textrm F}[\psi,\bar{\psi},U]$, and fermion degrees of freedom can be integrated out as
\begin{align}
\left<{O}(x_1,...,x_n)\right>&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]}\mathcal{Z}_{\textrm F}\notag \\
&\times\frac{1}{\mathcal{Z}_{\textrm F}}\left[\int\mathcal{D}[\psi,\bar{\psi}]{O}(x_1,...,x_n)e^{-S_{\textrm F}[\psi,\bar{\psi}]}\right] \\
&\equiv\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]}\mathcal{Z}_{\textrm F}\left<{O}(x_1,...,x_n)\right>_{\textrm F},
\end{align}
with 
\begin{align}
\mathcal{Z}_{\textrm F}&=\int\mathcal{D}[\psi,\bar{\psi}]e^{-S_{\textrm F}[\psi,\bar{\psi}]}=\Pi_{i=1}^{N_f}{\textrm{det}}\left(D\right).
\end{align}
This fermionic determinant can be expressed as an effective action as
\begin{align}
\left<{O}(x_1,...,x_n)\right>&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}\left<{O}(x_1,...,x_n)\right>_{\textrm F}, \\
\mathcal{Z}&=\int\mathcal{D}[U]e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}, \\
S_{\textrm{eff}}[U]&=-\sum_{i=1}^{N_f}{\textrm{log}}\;{\textrm{det}}\left(D\right).
\end{align}

In order to compute meson observables we will use meson interpolators, which are composite fermionic observables that share the same quantum numbers as the desired meson state. A generic meson interpolator has the form
\begin{equation}
{O}_A^{ij}(x)=\bar{\psi}^i(x)\Gamma_A\psi^j(x),
\end{equation}	
with $\Gamma_A$ a Gamma matrix or product of matrices. Thus, a meson two-point function reads
\begin{align}
\label{ch_foundation:eq:path_int}
\left<{O}_A^{ij}(x_1){O}_B^{ji}(x_2)\right>&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}\notag\\
&\times\left<\bar{\psi}^i(x_1)\Gamma_A\psi^j(x_1)\bar{\psi}^j(x_2)\Gamma_B\psi^i(x_2)\right>_{\textrm F}  \\
&=-\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}\notag\\
&\times{\textrm{tr}}\left(\Gamma_AD_i^{-1}(x_1,x_2)\Gamma_BD_j^{-1}(x_2,x_1)\right),
\end{align}
where the trace is over spin indices and $D_i$ is the massive Dirac operator for flavor $i$. The integral over the fields of eq.~(\ref{ch_foundation:eq:path_int}) is carried out by a Markov chain Monte Carlo process with a Boltzmann weight 
$e^{-S_G[U]-S_{\textrm{eff}}[U]}$ (see Appendices~\ref{appex_simulations},~\ref{appex_errors}). The outcome is an ensemble  of $N_{\textrm{cnfg}}$ gauge field configurations. Subsequently, the desired quantity
\begin{equation}
P=-{\textrm{tr}}\left(\Gamma_A D_i^{-1}(x_1,x_2)\Gamma_B D_j^{-1}(x_2,x_1)\right),
\end{equation}
is measured in the gauge configurations of the considered ensemble, and the expectation value is computed as
\begin{equation}
\left<P\right>=\frac{1}{N_{\textrm{cnfg}}}\sum_{i=1}^{N_{\textrm{cnfg}}}P_i+\mathcal{O}\left(\frac{1}{\sqrt{N_{\textrm{cnfg}}}}\right).
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Continuum limit}
\label{ch_foundation:sec:continuum-limit}

For the discussion in this subsection we follow~\citep{Hernandez:2009zz}. The lattice regularization provides with a natural energy cutoff $a^{-1}$, ensuring that any loop integral is finite in perturbation theory. In perturbative renormalization, it is necessary to take the cutoff to infinity, which on the lattice means taking the lattice spacing to $a\rightarrow0$. If the theory is renormalizable, any physical quantity (e.g. a mass $m_{\textrm{phys}}$) in units of the lattice spacing must vanish in the continuum limit
\begin{equation}
\label{ch_foundation:eq:ma0}
m_{\textrm{phys}}a\rightarrow0,
\end{equation}
since $m_{\textrm{phys}}$ remains finite in this limit. 

Physical quantities depend on the couplings of the theory, $m_{\textrm{phys}}(g_0)$. In turn, one can study how the couplings of the theory change as one approaches the continuum limit by decreasing $a$. To do so and for simplicity, we assume a single coupling $g_0$, and write the most general local effective action at some lattice spacing $a_1$
\begin{equation}
\label{ch_foundations:eq:Sa}
S(a_1)=g_0(a_1)\sum_i{O}_i,
\end{equation}
where ${O}_i$ are all possible local operators respecting the lattice symmetries. When working at a finer lattice spacing $a_2<a_1$, one can integrate out all the short-range extra degrees of freedom, and reabsorb them into a redefinition of the coupling, obtaining an effective action at the original scale $a_1$, $S^{(2)}(a_1)$, that has the same generic form as in eq.~(\ref{ch_foundations:eq:Sa}) but with different couplings
\begin{align}
S^{(2)}(a_1)&=g_0^{(2)}(a_1)\sum_iO_i, \\
g_0^{(2)}(a_1)&=R(g_0(a_1)).
\end{align}
$R$ here stands for the renormalization group (RG) transformation that defines the change in the coupling. It can be observed then that renormalizability corresponds to a fixed point $g_0^*$ of the RG transformation
\begin{equation}
R(g_0^*)=g_0^*.
\end{equation}

In the context of $SU(N)$ Yang-Mills theory, perturbation theory shows that at a fixed value of the renormalized coupling $g_R$ the bare coupling runs with the lattice spacing as
\begin{equation}
\label{ch_foundation:eq:beta-func}
a\frac{\partial g_0}{\partial a}\equiv\beta(g_0)=-\beta_0g_0^3-\beta_1g_0^5+...,
\end{equation}
where $\beta_{0,1}$ are universal coefficients (i.e. they do not depend on the renormalization scheme) and positive for $N=3$ colors and $N_f\leq6$ flavors, as in the case of QCD. This shows that $g_0=0$ is a fixed point of the RG transformations. Given that the fixed point is in the weak coupling regime, this perturbative argument is expected to be valid. Therefore, the continuum limit corresponds to
\begin{equation}
g_0\rightarrow0,
\end{equation}
or in terms of the inverse coupling $\beta$
\begin{equation}
\beta\rightarrow\infty.
\end{equation}

In practice, the continuum limit is approached by simulations with smaller and smaller values of the lattice spacing $a$. At a given value of $a$, a lattice observable deviates from its continuum result due to discretization effects. The Symanzik Effective Field Theory (SYMEFT) allows to organize these cutoff effects into a power-series in the lattice spacing~\citep{Symanzik:1983dc, Symanzik:1983gh, Luscher:1984xn}, which also incorporates logarithmic corrections~\citep{Husung:2022kvi}. To improve the control of the continuum extrapolation of the lattice data, it is desirable to subtract the leading lattice artifacts of $\mathcal{O}(a)$ following the Symanzik improvement program (see Sec.~\ref{ch_foundation:sec:impr}). The systematic uncertainty associated with the remaining higher order discretization effects can be estimated by considering a set of functional forms derived from the SYMEFT and by applying cuts to data with the largest lattice spacing.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Symanzik improvement program}
\label{ch_foundation:sec:impr}

In general, the Symanzik improvement program requires the on-shell $\mathcal{O}(a)$ improvement of both the action and the observables.
More specifically, in the case of mesonic matrix elements, the fermion bilinears need to be improved.

Symanzik improvement requires improving both the action of the theory and the lattice interpolators that enter the different correlators. 

In order to improve a lattice action, one can describe the target continuum theory in terms of an effective action in powers of the lattice spacing $a$
\begin{equation}
S_{\textrm{eff}}=\sum_{k\geq1}a^k\int d^4x\mathcal{L}_k(x).
\end{equation}
Here $\mathcal{L}_0(x)$ is the continuum QCD Lagrangian, which has mass-dimension $4$, while the $\mathcal{L}_k$ terms are all possible Lagrangians built from fermion and gluon field operators that preserve the symmetries of the regularized, i.e. lattice, theory, with mass-dimension $4+k$.

In the case of Lattice QCD, we saw that in the Wilson gauge action in eq.~(\ref{ch_foundation:eq:YM-latt}) lattice artifacts appear at $\mathcal{O}(a^2)$. The leading $\mathcal{O}(a^2)$ effects can be reduced by adding all possible dimension-$6$ operators that preserve the underlying symmetries of the gauge action. These dimension-6 operators are all three possible ways of writing a closed path in a rectangular lattice with 6 gauge links: planar, twisted and L-shaped rectangles. The action then reads
\begin{align}
\label{ch_foundation:eq:SG_impr}
S_G=\frac{\beta}{3}\sum_{\mu\nu}&\left[c_0(g_0^2)\sum_p{\textrm{Re}}\left({\textrm{tr}}\left(1-U_{\mu\nu}(p)\right)\right)\right. \notag \\
&\left.+\sum_{i=1}^3c_i(g_0^2)\sum_r{\textrm{Re}}\left({\textrm{tr}}\left(1-U^{(i)}(r)\right)\right)\right],
\end{align}
with $U^{(i)}$ the above mentioned dimension-6 operators. A non-perturbative determination of the coefficients $c_i$ would lead to $\mathcal{O}(a^2)$ improvement. The CLS ensembles that we employ in this thesis (see Sec.~\ref{ch_ma:sec:Sea}) use the so called Lüscher-Weisz gauge action~\citep{Luscher:1984xn,Luscher:1985zq}, with these coefficients computed at tree-level
\begin{gather}
\label{ch_foundation:eq:LW}
c_0=\frac{5}{3}, \quad
c_1=-\frac{1}{12}, \quad
c_2=c_3=0,
\end{gather}
thus leading to tree-level improvement of the action. The only dimension-6 operators that survive are planar rectangles $U^{(1)}$.

Since Wilson fermions receive $\mathcal{O}(a)$ lattice artifacts, the Symanzik improvement must be applied to the fermionic action in order 
to achieve on-shell $\mathcal{O}(a)$ improvement. This requires identifying all dimension $5$ operators that preserve the symmetries of the lattice regularization. There are 5 such operators, two of which can be eliminated by the use of the equations of motion. This is referred to as on-shell improvement, and the leading $\mathcal{O}(a)$ correction can be spanned by 
\begin{gather}
\label{ch_foundation:eq:L1}
\mathcal{L}_{k=1}^{(1)}=i\bar{\psi}(x)\sigma_{\mu\nu}\hat{F}_{\mu\nu}(x)\psi(x),\\
\mathcal{L}_{k=1}^{(2)}=\boldsymbol{m}{\textrm{tr}}\left(\hat{F}_{\mu\nu}(x)\hat{F}_{\mu\nu}(x)\right),\\
\mathcal{L}_{k=1}^{(3)}=\boldsymbol{m}^2\bar{\psi}(x)\psi(x),
\end{gather}
with
\begin{align}
\label{ch_foundation:eq:dim5-op}
\sigma_{\mu\nu}&=\frac{\left[\gamma_{\mu},\gamma_{\nu}\right]}{2i},\\
\label{ch_foundation:eq:F_clover}
\hat{F}_{\mu\nu}(x)&=\frac{-i}{8a^2}\left(Q_{\mu\nu}(x)-Q_{\nu\mu}(x)\right),\\
Q_{\mu\nu}&=U_{\mu\nu}(x)+U_{\nu,-\mu}(x)+U_{-\mu,-\nu}(x)+U_{-\nu,\mu}(x),
\end{align}
where
\begin{equation}
U_{\mu}^{\dagger}(x)=U_{-\mu}(x+\hat{\mu}).
\end{equation}
$\mathcal{L}_{k=1}^{(2),(3)}$ are already present (up to numerical factors) in the original Wilson fermion action and can therefore be reabsorbed in those terms. The $\mathcal{O}(a)$ improved Wilson Dirac operator appearing in the improved fermion action reads
\begin{equation}
\label{ch_foundation:eq:DW_impr}
D_{\textrm W}+\boldsymbol{m}+c_{\textrm{sw}}a\frac{1}{2}\sum_{\mu<\nu}\sigma_{\mu\nu}\hat{F}_{\mu\nu},
\end{equation}
with $c_{\textrm{sw}}$ the Sheikholeslami-Wohlert coefficient~\citep{Sheikholeslami:1985ij}.

On-shell improvement of the lattice action ensures improvement of spectral quantities such as meson masses. However, if one is interested in matrix elements mediated by some current $\mathcal{J}_{\mu}$, it is also necessary to improve the lattice definition of those currents. In analogy with the improvement of the action, a local operator $O$ is expressed in the Symanzik effective theory as
\begin{equation}
O_{\textrm{eff}}(x)=\sum_kO_k(x)a^k.
\end{equation}
Again, $O_k$ are combinations of gauge invariant local operators with the right mass-dimensions. Consequently, a generic n-point function reads
\begin{equation}
\label{ch_foundation:eq:Oimpr}
\left<\Phi\right>=\left<\Phi_0\right>-a\int d^4y\left<\Phi_0\mathcal{L}_1(y)\right>+a\left<\Phi_1\right>+...,
\end{equation}
with 
\begin{align}
\left<\Phi_0\right>&=\left<O_0(x_1)...O_0(x_n)\right>, \\
\left<\Phi_1\right>&=\sum_{i=1}^n\left<O_0(x_1)...O_1(x_i)...O_0(x_n)\right>,
\end{align}
and vacuum expectation values taken in terms of the continuum action. In Sec~\ref{ch_observables} we discuss the details of operator improvement for the observables of interest.

The $\mathcal{O}(a)$ improved Wilson tm fermion action is analogous to the Wilson case, with the improved Dirac operator given by 
\begin{equation}
\label{ch_foundations:eq:Wtm_csw}
D_{\textrm W}+\boldsymbol{m}+i\gamma_5\boldsymbol{\mu}+c_{\textrm{sw}}a\frac{1}{2}\sum_{\mu<\nu}\sigma_{\mu\nu}\hat{F}_{\mu\nu}.
\end{equation}
When considering a unitary setup,  Wilson tm fermions 
at maximal twist (i.e. for a vanishing standard quark mass) follow
an automatic $\mathcal{O}(a)$ improvement of physical observables~\citep{Frezzotti:2003ni,Shindler:2007vp}. This implies  that physical quantities receive leading lattice artifacts of $\mathcal{O}(a^2)$ 
 without the need of computing $\mathcal{O}(a)$ improvement coefficients. This statement holds also for a vanishing value of $c_{\textrm{sw}}$ in eq.~(\ref{ch_foundations:eq:Wtm_csw}). The following discussion is based on the original work~\citep{Frezzotti:2003ni} to which we refer for a complete proof.

At maximal twist and vanishing $c_{\textrm{sw}}$, the Wilson tm Dirac operator reads
\begin{equation}
D_{\textrm W}+i\boldsymbol{\mu}\gamma_5.
\end{equation}
In the twisted basis, the continuum action is invariant under a discrete chiral symmetry 
\begin{equation}
\mathcal{R}_5^{1,2}=\left\{\begin{matrix}
\psi(x)\rightarrow i\gamma_5\tau^{1,2}\psi(x) \\ 
\bar{\psi}(x)\rightarrow \bar{\psi}(x)i\gamma_5\tau^{1,2}
\end{matrix}\right.,
\end{equation}
while $\mathcal{L}_{k=1}^{(1)}$ in eq.~(\ref{ch_foundation:eq:L1}) is not 
\begin{equation}
\mathcal{L}_{k=1}^{(1)}\rightarrow-\mathcal{L}_{k=1}^{(1)}.
\end{equation}
This is key for automatic $\mathcal{O}(a)$ improvement. For correlation functions such as those in eq.~(\ref{ch_foundation:eq:Oimpr}), operators can be even or odd under $\mathcal{R}_5$. In particular, $\left<\Phi_0\right>$ and $\left<\Phi_1\right>$ have $\mathcal{R}_5$-chirality opposite to each other
\begin{gather}
\left<\Phi_0\right>\rightarrow\pm\left<\Phi_0\right>, \quad \left<\Phi_1\right>\rightarrow\mp\left<\Phi_1\right>.
\end{gather}
This implies that for even $\left<\Phi_0\right>$
\begin{gather}
\left<\Phi_0\right>=\left<\Phi_0\right>,
\quad \left<\Phi_0\mathcal{L}^{(1)}_{k=1}\right>=-\left<\Phi_0\mathcal{L}^{(1)}_{k=1}\right>=0, \quad \\ \left<\Phi_1\right>=-\left<\Phi_1\right>=0,
\end{gather}
and thus even operators are automatically $\mathcal{O}(a)$ improved. On the other hand, for odd operators 
\begin{gather}
\left<\Phi_0\right>=-\left<\Phi_0\right>=0, \quad
\left<\Phi_0\mathcal{L}^{(1)}_{k=1}\right>=\left<\Phi_0\mathcal{L}^{(1)}_{k=1}\right>, \quad \\ \left<\Phi_1\right>=\left<\Phi_1\right>,
\end{gather}
and thus they vanish in the continuum. Therefore, the only tuning required for Wilson tm fermions to achieve $\mathcal{O}(a)$ improvement is that of the bare quark mass $m$, which must be set to zero in order to obtain maximal twist.

In our particular case, we will be working with a mixed action setup employing standard Wilson quarks in the sea and fully twisted Wilson tm quarks in the valence (see Sec~\ref{ch_ma}). This entails that valence-sector observables will receive residual $\mathcal{O}(a)$ cutoff effects proportional to the sea-quark masses, and thus improvement is still needed. These effects are expected to be $\mathcal{O}\left(g_0^4{\textrm{tr}}\left(M_q^{\textrm{(s)}}\right)\right)$ in perturbation theory, with $M_q^{\textrm{(s)}}$ the sea-quark mass matrix (see Sec.~\ref{ch_ma}).

Finally, we also need to improve the bare gauge coupling, which at $\mathcal{O}(a)$ reads
\begin{equation}
\tilde{g}_0^2=g_0^2\left(1+ab_g{\textrm{tr}}\left(M_q^{\textrm{(s)}}\right)\right),
\end{equation}
with $b_g$ the improvement coefficient, whose value at one-loop is given in~\citep{Luscher:1996sc}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Scale setting}
\label{ch_foundation:sec:ss}

On the lattice, all physical observables are computed in units of the lattice spacing $a$. A minimal set of external quantities is used as input to fix the values of the fundamental parameters of the theory. In the case of QCD with $N_f$ quark flavors, one requires $N_f$ observables to fix the quark masses (e.g. one can consider renormalized quark masses or pseudoscalar meson masses) and one additional input to fix the QCD scale (or, equivalently, to fix the renormalization scale at which the renormalized coupling takes a specific value). Through such a scale setting, it is possible to determine the value of the lattice spacing in physical units for each value of the bare gauge coupling considered in the simulations. In practice, it is beneficial to introduce an intermediate scale -- such as the gradient flow scale $t_0$~\citep{Luscher:2010we,1006.4518} -- that allows one to construct dimensionless quantities from the minimal set of observables involved in the scale setting procedure. These dimensionless quantities are then used to define the line of constant physics along which the target observables are extrapolated to the continuum limit. By matching the extrapolated continuum-limit result, at the physical values of the quark masses, with the external input, it is then possible to determine the physical value of the intermediate scale. The accuracy achieved in the intermediate scale determination can then be transferred to the accuracy of the scale setting procedure. As discussed in the introduction, a sub-percent accuracy in scale setting is a necessary condition for some of the more precise lattice QCD calculations relevant to precision tests of the SM. 

The pion and kaon meson masses are generally used to set the physical values of the $u$/$d$ and $s$ quark masses. On the other hand, baryon masses like the $\Omega$ or the $\Xi$ baryon mass are popular choices of external input to set the scale~\citep{BMW:2012hcm,Miller:2020evg,RQCD_scale}. The former is determined with high accuracy experimentally~\citep{ParticleDataGroup:2020ssz} but suffers from the signal-to-noise problem~\citep{Lepage:1989hd,Luscher:2010ae} on the lattice determination. This problem is also present in the $\Omega$ baryon mass, but to a somewhat reduced extent~\citep{BMW:2012hcm,Miller:2020evg}. Furthermore, the $\Omega$ baryon mass has a weak dependence on the light quark masses and a strong one in the strange quark mass. This makes it an interesting scale for chiral trajectories with constant strange quark mass. Given the current precision, electromagnetic corrections are expected to be small for the $\Xi$ and $\Omega$ baryons~\cite{RQCD_scale}. In the past, the $\rho$ meson mass was used to set the scale of quenched simulations~\citep{Mawhinney:1996jk,Irving:1998yu,Bornyakov:2015plz}, but  its large decay width makes it unsuitable for quark dynamical simulations. The $\Upsilon$ meson mass spectrum has also been considered~\citep{HPQCD:2011qw,Gray:2005ur} due to its precise experimental determination. However, it is still challenging to bring down the systematic uncertainties associated to $b$-physics computations to the level required in the scale setting procedure. An alternative choice to set the scale is to use light pseudoscalar meson decay constants~\citep{Brown:2018jtv,BMW:2012hcm,BMW:2012hcm,Bruno:2016plf,Strassberger:2023xnj}. In particular, in this work we will follow~\citep{Bruno:2016plf} and consider a linear combination of the pion and kaon decay constants. The zero-momentum pion correlator is protected from an exponential increase of the noise at large Euclidean times, while it is present in the case of the kaon but only to a  reduced extent. The pion and kaon decay constants can therefore be determined with high precision on the lattice. However, their physical values are extracted from the experimental measurements of the leptonic decay rates $\pi/K\to\ell\bar{\nu}$. More specifically, the decay rate receives electromagnetic corrections which require to take into account a dependence on the energy of photon emission. A prescription to subtract these QED radiative corrections has to be selected in order to arrive at a determination $V_{ud(us)}f_{pi(K)}$ based on the experimental measurements of the decay rates. The uncertainty on the extracted values of $f_{\pi,K}$ thus depends on how accurately the CKM matrix elements $V_{ud,us}$ are determined~\citep{FlavourLatticeAveragingGroupFLAG:2021npn}. At present, the uncertainty introduced by $V_{us}$ dominates that of $V_{ud}$. Furthermore, the systematic uncertainties associated to radiative corrections are at present larger for the case of kaon decay constant as compared to the pion case~\citep{FlavourLatticeAveragingGroupFLAG:2021npn}.

We employ the gradient flow scale $t_0$~\citep{Luscher:2010we,1006.4518}, introduced in Sec.~\ref{ch_observables:sec:Flow}, as an intermediate quantity in the scale setting. Although it is not an experimentally accessible quantity its physical value can be determined with high-precision on the lattice~\citep{Bruno:2016plf,Strassberger:2023xnj,RQCD_scale,Kostrzewa:2021syw,Hollwieser:2020qri,MILC:2015tqx}. Since it is a gluonic observable its quark mass dependence arises solely from sea-quark effects. The smearing radius $\sqrt{8t_0} \approx 0.4$ fm  is such that finite volume effects are small on typical lattice sizes with $L > 2$ fm and $m_{\pi} L > 4$. To determine its value in the continuum and at physical quark masses, one constructs a dimensionless quantity $(\sqrt{t_0}\Lambda)^{\textrm{latt}}$, where $\Lambda$ is one of the quantities previously described (e.g. $f_{\pi}$, $f_{\pi K}$, $m_{\Omega}$, ...). After taking the continuum limit along the line of constant physics followed by an extrapolation/interpolation to the physical point, the physical value of $t_0$ can be extracted as follows
\begin{equation}
\label{ch_foundation:eq:Lambda}
\sqrt{t_0^{\textrm{ph}}}=\frac{\left.\begin{matrix}
\left(\sqrt{t_0}\Lambda\right)^{\textrm{latt}}
\end{matrix}\right|_{a=0}}{\Lambda^{\textrm{exp}}}.
\end{equation}
As already anticipated, the approach to the physical values of the quark masses often requires some extrapolations/interpolations. This is because Lattice QCD simulations often include ensembles with unphysical values of the quark mass. At present, the simulations at the physical point are feasible but they are still computationally challenging due to the small value of the physical light quark masses and the necessity to keep the lattice size large enough to maintain finite volume effects under control. This implies that additional simulations with heavier light quark masses provide important information to control the physical results and to estimate the systematic effects present in the computation. The chiral and continuum extrapolations considered in the scale setting procedure will be discussed in Sec.~\ref{ch_ss}.

Once $t_0$ has been determined, it can be used to predict any other quantity $\Lambda'$ (for simplicity assumed to be of mass-dimension one) in physical units. For this purpose, one performs a continuum extrapolation of $\sqrt{t_0}\Lambda'$ and obtains the physical value of $\Lambda'$ as
\begin{equation}
\Lambda^{\textrm{' ph}}=\frac{\left.\begin{matrix}
\left(\sqrt{t_0}\Lambda'\right)^{\textrm{latt}}
\end{matrix}\right|_{a=0}}{\sqrt{t_0^{\textrm{ph}}}}.
\end{equation}

Finally, in addition to $t_0$, other intermediate scales considered on the lattice are $w_0$~\citep{BMW:2012hcm,Kostrzewa:2021syw,MILC:2015tqx} which like $t_0$ is also based on the gradient flow action density, or the Sommer scale $r_0$~\citep{Sommer:1993ce,Necco:2001xg,Bernard:2000gd} which is derived from the static quark-antiquark potential extracted from Wilson loops. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Local Variables:
%%% mode: LaTeX
%%% TeX-master: "../ClassicThesis"
%%% End:
