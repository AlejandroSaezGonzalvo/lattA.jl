\chapter{QCD on the lattice}\addcontentsline{toc}{chapter}{QCD on the lattice}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\label{ch_foundation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Motivation}
\label{ch_foundation:sec:general}

The theory that describes the strong interactions between quarks and gluons is called Quantum Chromodynamics, or QCD. 

The underlying symmetry of QCD is associated to the non-abelian SU($N$=3) Lie group. The elements of this group are non-commuting, traceless unitary $3 \times 3$ matrices $\Omega$ whose determinant $\textrm{det}\;\Omega=1$. In order to have a gauge theory, which means that the theory is invariant under local SU(3) transformations, we must allow these elements to depend on space-time coordinates. One way to parametrize these matrices is
\begin{equation}
\Omega(x)=e^{i\alpha^{(a)}(x)T^{(a)}},
\end{equation}
where summation over $a=1,...,N^2-1=8$ is implicit and $T^{(a)}$ are the 8 generators of the SU(3) Lie group. These live in the Lie algebra su(3), which is the tangent space to the group SU(3) at the identity $I\in$ SU(3). They satisfy the commutation relations
\begin{equation}
[T^{(a)}, T^{(b)}]=if_{abc}T^{(c)},
\end{equation}
where $f_{abc}$ are the structure constants of the group. Unitarity of the group elements means that
\begin{equation}
\Omega^{\dagger}\Omega=1.
\end{equation}

The group elements $\Omega$ must be in some representation, which determines how they act on a vector space where the degrees of freedom live. In QCD these are quarks and gluons. The former are described by spinor fields $\psi_{\alpha,i},\bar{\psi}_{\alpha,i}$. They carry a Dirac spinor index $\alpha=1,2,3,4$ and a flavor index $i=1,...,N_f$, to each flavor corresponding a different mass (in Nature $N_f=6$). They transform under SU(3) in the fundamental representation, meaning
\begin{gather}
\psi(x)\to\Omega(x)\psi(x), \quad \bar{\psi}(x)\to\bar{\psi}(x)\Omega(x)^{\dagger}.
\end{gather}
They thus live in a 3-dimensional vector space, having an additional index $c=1,2,3$, called color. Being spinor fields, their dynamics is governed by the Dirac action
\begin{equation}
S_{\textrm{F}}=\sum_{i=1}^{N_f}\int d^4x\;\bar{\psi}^{i}(x)\left(\gamma_{\mu}\partial_{\mu}+m_i\right)\psi^i(x).
\end{equation} 
We implicitly sum over the repeated $\mu$ index, and we ommited the spinor and color indices. This action is invariant under global SU(3) transformations ($\Omega$ independent of $x$). In order to promote this to a local or gauge symmetry, we need to substitute the derivative by a covariant one
\begin{equation}
\partial_{\mu}\psi(x)\to D_{\mu}(x)\psi(x)=\partial_{\mu}\psi(x)+iA_{\mu}(x)\psi(x),
\end{equation}
with $A_{\mu}$ a new field, called the gauge field, which must transform in the adjoint representation under SU(3)
\begin{equation}
\label{ch_foundation:eq:Agauge}
A_{\mu}(x)\to\Omega(x)A_{\mu}(x)\Omega^{\dagger}(x)+i\left(\partial_{\mu}\Omega(x)\right)\Omega^{\dagger}(x),
\end{equation}
in order to ensure gauge invariance. This means the new field $A_{\mu}$ lives in the su(3) algebra, and thus it is a hermitian, traceless $3\times 3$ matrix which can be decomposed as a linear combination of the algebra generators $T^{(a)}$
\begin{equation}
A_{\mu}=A_{\mu}^{(a)}T^{(a)},
\end{equation}
where we again implicitly sum over the repeated index $a$. The gauge or gluon fields must have a kinetic piece in the complete QCD action. The most general term which satisfy gauge invariance is
\begin{equation}
\frac{1}{2g_0^2}{\textrm{tr}}\left(F_{\mu\nu}(x)F_{\mu\nu}(x)\right),
\end{equation}
where $g_0$ is a dimensionless parameter (the coupling) and the energy strength tensor $F_{\mu\nu}$ is given by
\begin{align}
F_{\mu\nu}(x)&=\partial_{\mu}A_{\nu}(x)-\partial_{\nu}A_{\mu}(x)+i\left[A_{\mu}(x),A_{\nu}(x)\right].
\end{align}
Again, this object lives in the su(3) algebra and can be expressed as
\begin{equation}
F_{\mu\nu}=F_{\mu\nu}^{(a)}T^{(a)},
\end{equation}
writing the kinetic part of the action for the gauge fields as
\begin{equation}
\label{ch_foundation:eq:SYM}
\frac{1}{2g_0^2}\int d^4x\;\textrm{tr}(F_{\mu\nu}(x)F_{\mu\nu}(x)).
\end{equation}
This is the Yang-Mills action, which is the action for gauge fields in the absence of matter fields. From the transformation in eq.~(\ref{ch_foundation:eq:Agauge}) we derive the transformation relations of $F_{\mu\nu}$
\begin{align}
F_{\mu\nu}(x)&\to\Omega(x)F_{\mu\nu}(x)\Omega^{\dagger}(x).
\end{align}

Finally, the QCD action in continuum space-time is given by 
\begin{align}
\label{ch_foundation:eq:QCD}
S_{\textrm{QCD}}&=\sum_{i=1}^{N_f}\int d^4x\;\bar{\psi}^i(x)\left(\gamma_{\mu}D_{\mu}(x)+m_i\right)\psi^i(x) \\
&+\frac{1}{2g_0^2}\int d^4x\;{\textrm{tr}}\left(F_{\mu\nu}(x)F_{\mu\nu}(x)\right).
\end{align}
The only parameters of this action are the quark masses $m_i$ and the dimensionless coupling constant $g_0$.

QCD has many remarkable properties. One of the most important is asympotic freedom and confinement. Asymptotic freedom means that at high energies (short distances) the coupling runs to small values and thus the theory becomes weakly coupled. On the other hand, at low energies (large distances) the theory is strongly coupled. This is responsible for some of the most remarkable properties of the theory. Most importantly, perturbation theory cannot be used to study this energy regime as the coupling is not weak and an expansion in powers of it does not converge. It is in this non-perturbative regime that most of the interesting phenomena of QCD happens, such as color confinement and spontaneous chiral symmetry breaking. The first is responsible for the fact that no color charged particles can be observed in Nature at low energies, but only color singlet composite particles, such as mesons and baryons. This means that altough the degrees of freedom of the theory are quarks and gluons, the spectrum at low energies consists of composite massive particles. This is belived to give rise to a mass gap, since altough gluons are massless, at low energies they are believed to bound in massive composite states known as glueballs. On the other hand, the theory enjoys an approximate chiral symmetry for the light quarks, which is spontaneously broken by non-perturbative dynamics, resulting in the appearance of pseudo Nambu-Goldston bosons: pions. This explains the small mass of these particles. 

The only know first-principles method (other than perturbation theory) to perform theoretical predictions in Quantum Field Theory is Lattice Quantum Field Theory, or Lattice QCD when applied to the study of Quantum Chromodynamics. This method is based on the discretization of space-time into a hypercubic box or lattice
\begin{equation}
\Lambda=\{n_0,n_1,n_2,n_3|n_0=0,...,T/a-1;n_i=0,...,L/a-1;i=1,2,3\},
\end{equation} 
where $a$ is the lattice spacing between two adjacent sites, and $L,T$ are the spatial and temporal lattice extents (in physical units) respectively. The discretization of space-time and introduction of a finite lattice spacing $a$ provides a natural energy cutoff for momenta $\sim a^{-1}$, removing UV divergences. On the other hand, the finite volume lattice ensures the absence of IR divergences. This means that the lattice formulation can be seen as a way to regularize any particular Quantum Field Theory. However, this also implies the presence of finite volume and discretization effects, which should be removed from the predictions. To do this, after having computed the physical observables in the lattice setup, one must perform a continuum extrapolation to obtain results at $a\rightarrow0$ and simulate large enough volumes in order to be able to neglect the effects associated with finite volume. If the theory is renormalizable, physical quantities will remain finite in the continuum limit.

Having discretized spacetime, fields are placed at the lattice sites $n\in\Lambda$. Fermions thus look like
\begin{gather}
\psi(n),\bar{\psi}(n), \quad
n\in\Lambda.
\end{gather}
For the gauge fields, it will be helpful to use the definition of a parallel transporter in SU($N$). An $N$-component unit vector $\boldsymbol{v}$ is parallel transported along a curve parameterized by $z_{\mu}(t)$ from point $z_{\mu}(a)=x$ to $z_{\mu}(b)=y$ as
\begin{align}
\boldsymbol{v}(b)&=P(y,x)\boldsymbol{v}(a),\\
P(y,x)&=e^{i\int_x^yA_{\mu}(z)dz_{\mu}},
\end{align}
with $A_{\mu}$ the SU($N$) gauge fields. This means that a fermion in the fundamental representation picks up a phase of $P(y,x)$ when going from $x$ to $y$. This parallel transporter is called a gauge link and its discrete version will be the variable to be used in the lattice for the gauge fields. It is an element of the group and transforms as
\begin{equation}
P(x,y)\to\Omega(x)P(x,y)\Omega^{\dagger}(y).
\end{equation}

Having defined the fields in the lattice, one needs to discretize the QCD action, formulating it in a finite box $\Lambda$ in terms of said fields in such a way that in the continuum limit $a\rightarrow 0$ the continuum QCD action is recovered. We discuss this in the following sections.	

The Chapter is structured as follows. In Sec.~\ref{ch_foundation:sec:Gauge} we show the Wilson formulation of the gauge action in the lattice, in terms of the link variables. In Sec.~\ref{ch_foundation:sec:Fermions} we show different ways of discretizing the fermion action. In Sec.~\ref{ch_foundation:subsec:Naive} we discuss the problem of doublers that appear with a naive fermion discretization and its relation with formulating chiral symmetry in the lattice, briefly commenting on Ginsparg-Wilson fermions. In Sec.~\ref{ch_foundation:subsec:Wilson} we show the solution to the doublers problem proposed by Wilson, which implies adding a term which explicitly breaks chiral symmetry. This term gives a heavy mass to the doublers that grows with the inverse of the lattice spacing $a$, and thus they decouple in the continuum. In Sec.~\ref{ch_foundation:subsec:tm} we discuss a modification of Wilson fermions which adds a chirally rotated mass term. This regularization poses some advantages which will be of importance for our study. In Sec.~\ref{ch_foundation:sec:path} we review some concepts of the path integral formalism and how expectation values are computed numerically in the lattice. In Sec.~\ref{ch_foundation:sec:continuum-limit} we review some concepts of renormalizability and the continuum limit in the lattice. In Sec.~\ref{ch_foundation:sec:impr} we discuss the Symanzik improvement program, which allows to reduce cutoff effects associated to the lattice action and fields, helping in the task of performing the continuum limit. Finally, in Sec.~\ref{ch_foundation:sec:ss} the procedure to set the scale in the lattice is discussed. This is necessary in order to extract lattice predictions in physical units.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Pure gauge SU(3) in the lattice}
\label{ch_foundation:sec:Gauge}

In the lattice, gluon fields can be defined by the link variables $U_{\mu}(x)\in$ SU(3) that act as a discrete version of the gauge transporters connecting points $x$ and $x+\hat{\mu}$, with $\hat{\mu}=\{a\hat{x}_0,a\hat{x}_1,a\hat{x}_2,a\hat{x}_3\}$
\begin{equation}
\label{ch_foundation:eq:U}
U_{\mu}(x)=\exp\left(iaA_{\mu}(x)\right).
\end{equation}
The gauge fields transform as 
\begin{equation}
\label{ch_foundation:eq:U_transf}
U_{\mu}(x)\to\Omega(x)U_{\mu}(x)\Omega^{\dagger}(x+\hat{\mu}),
\end{equation}
These fields live on the links of the lattice that connect sites $x$ and $x+\hat{\mu}$.

A common discretization of the gluonic action is the Wilson gauge action~\citep{Wilson:1974sk}, which is expressed in terms of the link variables $U_{\mu}(x)$
\begin{equation}
\label{ch_foundation:eq:SG}
S_{\textrm{G}}=\frac{1}{g_0^2}\sum_x\sum_{\mu,\nu}{\textrm{Re\; tr}}\left(1-U_{\mu\nu}(x)\right),
\end{equation} 
where $U_{\mu\nu}(x)$ is the plaquette centered on the lattice site $x$
\begin{equation}
\label{ch_foundation:eq:plaq}
U_{\mu\nu}(x)=U_{\mu}(x)U_{\nu}(x+\hat{\mu})U_{\mu}^{\dagger}(x+\hat{\nu})U_{\nu}^{\dagger}(x),
\end{equation}
and we have used 
\begin{equation}
U_{\mu}^{\dagger}(x)=U_{-\mu}(x+\hat{\mu}).
\end{equation}
Using the Baker-Campbell-Hausdorff formula iteratively
\begin{equation}
\exp\left(A\right)\exp\left(B\right)=\exp\left(A+B+\frac{1}{2}\left[A,B\right]+...\right),
\end{equation}
and using eq.~(\ref{ch_foundation:eq:U}) we get
\begin{equation}
\label{ch_foundation:eq:YM-latt}
S_{\textrm{G}}=a^4\frac{\beta}{3}\sum_x\sum_{\mu,\nu}{\textrm{tr}}\left(F_{\mu\nu}^2(x)\right)+\mathcal{O}(a^2),
\end{equation}
where we introduced the inverse coupling
\begin{equation}
\beta=\frac{6}{g_0^2}.
\end{equation}
Taking the continuum limit $a^4\sum_x\rightarrow\int d^4x$ we recover the continuum Yang-Mills action.

Eq.~(\ref{ch_foundation:eq:YM-latt}) shows that the effects related to the discretization of spacetime are of order $\mathcal{O}(a^2)$ for the Wilson gauge action. The discretization of the SU(3) pure Yang-Mills action is not unique, and different choices result in different cutoff effects.

The $\mathcal{O}(a^2)$ cutoff effects present in the Wilson regularization of the gauge action can be further reduced by adding additional terms that respect the symmetries of the theory following the Symanzik improvement program. One such choice is the Lüscher-Weisz action~\citep{Luscher:1984xn}, which we discuss in Sec.~\ref{ch_foundation:sec:impr}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Introducing fermions in the lattice}
\label{ch_foundation:sec:Fermions}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

After discretizing the SU(3) gauge action, we still need to find a suitable discrete version of the fermion action in eq.~(\ref{ch_foundation:eq:QCD}) to fully formulate QCD on the lattice. It will be shown that theoretical challenges arise with the naive fermion discretization and how these can be addressed with alternative formulations.

\subsection{Naive fermions}
\label{ch_foundation:subsec:Naive}

To discretize the continuum fermion action in the absence of gauge fields, considering only one flavor with mass $m$,
\begin{equation}
S_{\textrm{F}}=\int d^4x\bar{\psi}(x)\left(\gamma_{\mu}\partial_{\mu}+m\right)\psi(x),
\end{equation}
the derivative $\partial_{\mu}$ needs to take a discrete form, which can be done easily by
\begin{equation}
\partial_{\mu}\psi(x)\rightarrow\hat{\partial}_{\mu}\psi(x)=\frac{1}{2a}\left(\psi(x+\hat{\mu})-\psi(x-\hat{\mu})\right).
\end{equation}
To respect gauge symmetry in our action, we must promote the derivative $\hat{\partial}_{\mu}$ to a covariant one, as in the continuum case. To achieve this, we note that terms like
\begin{equation}
\bar{\psi}(x)\psi(x+\hat{\mu}),
\end{equation}
which arise from $\bar{\psi}(x)\hat{\partial}_{\mu}\psi(x)$ are not gauge invariant
\begin{equation}
\bar{\psi}(x)\psi(x+\hat{\mu})\to\bar{\psi}(x)\Omega^{\dagger}(x)\Omega(x+\hat{\mu})\psi(x+\hat{\mu}).
\end{equation}
The solution is again to introduce the link variable or parallel transporter $U_{\mu}(x)$ from site $x$ to $x+\hat{\mu}$ defined in eq.~(\ref{ch_foundation:eq:U}) which transforms as in eq.~(\ref{ch_foundation:eq:U_transf}). This way, the discretized fermion action reads
\begin{equation}
\label{ch_foundation:eq:naive}
S_{\textrm{F}}=a^4\sum_x\bar{\psi}(x)\left(\gamma_{\mu}\frac{U_{\mu}(x)\psi(x+\hat{\mu})-U_{\mu}^{\dagger}(x-\hat{\mu})\psi(x-\hat{\mu})}{2a}+m\psi(x)\right).
\end{equation}

However, this naive formulation of the fermion action exhibits the problem of doubling. This means that although we wrote our action to describe one fermion of mass $m$, for finite lattice spacing $a$ additional poles with the same ground state energy will appear, spoiling the dynamics of the theory. These unwanted additional poles are known as doublers. To see how they appear, consider the massive Dirac operator $D(x,y)$ in the continuum, which can be defined such that
\begin{equation}
S_{\textrm{F}}=\int d^4xd^4y\;\bar{\psi}(x)D(x,y)\psi(y).
\end{equation}
In the lattice this takes the form
\begin{equation}
S_{\textrm{F}}=a^4\sum_{n,m}\bar{\psi}(n)D(n,m)\psi(m),
\end{equation}
with the Dirac operator for the naive fermion formulation given by
\begin{equation}
D(n,m)=\gamma_{\mu}\frac{U_{\mu}(n)\delta_{n+\hat{\mu},m}-U_{\mu}^{\dagger}(n-\hat{\mu})\delta_{n-\hat{\mu},m}}{2a}+m\delta_{n,m}.
\end{equation}
Restricting to the free massless fermion case $U_{\mu}=1$ for illustration, upon Fourier transform we get
\begin{align}
\tilde{D}(p,q)&=\frac{1}{V}\sum_{n,m}e^{-ip\times na}D(n,m)e^{iq\times ma}\\
&=\frac{1}{V}\sum_{n,m}e^{-i(p-q)na}\left(\gamma_{\mu}\frac{e^{iq_{\mu}a}-e^{-iq_{\mu}a}}{2a}\right)\\
&=\delta(p-q)\tilde{D}(p),
\end{align}
with $V$ the 4-dimensional volume of the lattice and
\begin{equation}
\tilde{D}(p)=\sum_{\mu}\frac{i}{a}\gamma_{\mu}\textrm{sin}(p_{\mu}a),
\end{equation}
where we made explicit again the sum over $\mu$. The inverse of this operator can be computed as
\begin{equation}
\label{ch_foundations:eq:Dinv}
\tilde{D}^{-1}(p)=\frac{ia^{-1}\sum_{\mu}\gamma_{\mu}sin(p_{\mu}a)}{a^{-2}\sum_{\mu}sin(p_{\mu}a)^2}.
\end{equation}
We can see that in the continuum $a\rightarrow0$ we recover the correct form of the Dirac operator
\begin{equation}
\tilde{D}(p)^{-1}|_{m=0}\rightarrow_{a\rightarrow0}\frac{-i\gamma_{\mu}p_{\mu}}{p^2}
\end{equation}
with one single pole at $p^2=0$. However, at finite lattice spacing, the denominator in eq.~(\ref{ch_foundations:eq:Dinv}) vanishes not only for $p=(0,0,0,0)$ but also for 
\begin{equation}
p=(\pi/a,0,0,0),\;(0,\pi/a,0,0),\;...,\;(\pi/a,\pi/a,\pi/a,\pi/a).
\end{equation}
These are 15 unwanted poles, the doublers, that only disappear in the continuum, once they become infinitely heavy. These doublers have the same ground energy as the true pole at $p^2=0$ and they affect the dynamics of the theory. 

The problem of doublers is related to chiral symmetry and its implementation in the lattice. Chiral symmetry in continuum QCD can be expressed as 
\begin{equation}
\label{ch_foundation:eq:chirality}
\{D,\gamma_5\}=0,
\end{equation}
with $D$ the Dirac operator. There's a theorem by Nielsen and Ninomiya~\citep{Nielsen:1980rz}-\citep{Nielsen:1981hk} that states that one cannot implement chiral symmetry in the way of eq.~(\ref{ch_foundation:eq:chirality}) in the lattice without the appearance of doublers. In this lattice formulation of chiral symmetry, there must be an equal number of right movers and left movers. In particular, this means having just one pole is not possible. Ginsparg and Wilson~\citep{Ginsparg:1981bj} proposed a suitable version of chiral symmetry for the lattice as
\begin{equation}
\label{ch_foundation:eq:chirality-latt}
\{D,\gamma_5\}=aD\gamma_5D,
\end{equation}
such that in the continuum eq.~(\ref{ch_foundation:eq:chirality}) is recovered. With this definition of chiral symmetry in the lattice, it is possible to construct Dirac operators that satisfy eq.~(\ref{ch_foundation:eq:chirality-latt}) and are free of doublers. 

If one is not interested in studying physics related to chiral symmetry, another choice is to build a Dirac operator that explicitly breaks chiral symmetry but removes the doublers. Wilson fermions and Wilson twisted mass fermions are examples of such a choice, which we will now study.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Wilson fermions}
\label{ch_foundation:subsec:Wilson}

Wilson proposed~\citep{Wilson:1974sk} adding an extra term to the naive fermion action in eq.~\eqref{ch_foundation:eq:naive} to distinguis the doublers from the true pole. The Wilson fermion action reads
\begin{equation}
\label{ch_foundation:eq:Wil_fer}
S_{\textrm{W}}=a^4\sum_x\bar{\psi}(x)\frac{1}{2}\left(\gamma_{\mu}\left(\nabla_{\mu}+\nabla_{\mu}^*\right)+2m-a\nabla_{\mu}\nabla_{\mu}^*\right)\psi(x),
\end{equation}
where we have defined the forward and backward discrete covariant derivatives as
\begin{align}
\nabla_{\mu}\psi(x)&=\frac{U_{\mu}(x)\psi(x+\hat{\mu})-\psi(x)}{a},\\
\nabla_{\mu}^*\psi(x)&=\frac{\psi(x)-U_{\mu}^{\dagger}(x-\hat{\mu})\psi(x-\hat{\mu})}{a}.
\end{align}
From the Wilson fermion action~\eqref{ch_foundation:eq:Wil_fer} the Wilson Dirac operator reads
\begin{equation}
\label{ch_foundation:eq:DW}
D=D_{\textrm{W}}+m=\frac{1}{2}\left(\gamma_{\mu}\left(\nabla_{\mu}+\nabla_{\mu}^*\right)-a\nabla_{\mu}\nabla_{\mu}^*\right)+m,
\end{equation}
where we have introduced the massless Wilson Dirac operator $D_{\textrm{W}}$, and the action can be written as
\begin{equation}
S_{\textrm{W}}=a^4\sum_x\bar{\psi}(x)\left(D_{\textrm{W}}+m\right)\psi(x).
\end{equation}
For $N_f$ flavors, an additional sum over a flavor index $i=1,...,N_f$ is required, and $m$ is promoted to a diagonal matrix in flavor space, whose diagonal elements are $m_i$. The fermion mass $m_i$ is commonly expressed in terms of the $\kappa$ parameter
\begin{equation}
\label{ch_foundation:eq:kappa}
\kappa_i=\frac{1}{2am_i+8}.
\end{equation}
The momentum space massless Dirac operator reads
\begin{equation}
\tilde{D}_{\textrm{W}}(p)=\frac{i}{a}\sum_{\mu}\gamma_{\mu}\textrm{sin}(p_{\mu}a)+\frac{1}{a}\sum_{\mu}\left(1-\textrm{cos}(p_{\mu}a)\right).
\end{equation}
The third summand in the r.h.s. comes from the Wilson extra term $a\nabla_{\mu}\nabla_{\mu}^*$ in the action, and it is responsible for giving to the doublers an additional mass term
\begin{equation}
\frac{2l}{a},
\end{equation}
where $l$ is the number of momentum components with $p_{\mu}=\pi/a$ for the doubler. This additional mass distinguisses the doublers from the true pole and makes them decouple as we approach the continuum limit.

The Wilson term $a\nabla_{\mu}\nabla_{\mu}^*$ in the Wilson Dirac operator manifestly breaks chiral symmetry, even in the $m_i=0$ limit, and this symmetry is only restored in the continuum limit. Consequently, the quark mass receives additive renormalization contributions, 
\begin{equation}
m_i^{\textrm{R}}=Z_m\left(m_i-m_{\textrm{cr}}\right),
\end{equation}
since it is not protected against renormalization by the axial symmetry.

The Wilson fermion action has $\mathcal{O}(a)$ cutoff effects, which again can be systematically reduced by using the Symanzik improvement program detailed in Sec.~\ref{ch_foundation:sec:impr}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Wilson twisted mass fermions}
\label{ch_foundation:subsec:tm}

Wilson twisted mass (tm) fermions~\citep{Frezzotti:1999vv},\citep{Frezzotti:2000nk},\citep{Frezzotti:2001ea},\citep{Frezzotti:2003ni},\cite{Shindler:2007vp} introduce an imaginary mass term to the Wilson Dirac operator in eq.~\eqref{ch_foundation:eq:DW} of the form
\begin{equation}
i\bar{\psi}(x)\boldsymbol{\mu}\gamma_5\psi(x),
\end{equation}
with the twisted quark mass matrix in flavor space with four flavors of quarks (as will be our case of interest) given by
\begin{equation}
\boldsymbol{\mu}={\textrm{diag}}\left(\mu_u,-\mu_d,-\mu_s,\mu_c\right).
\end{equation}
More generally, the Wilson tm Dirac operator reads
\begin{equation}
D=D_{\textrm{W}}+\boldsymbol{m}+i\boldsymbol{\mu}\gamma_5.
\end{equation}
By rotating the fields
\begin{gather}
\label{ch_foundation:eq:chiral_rot}
\psi~\to~\psi' = e^{-i\frac{\pi}{2}\gamma_5 \frac{T}{2}}\psi, \quad
\bar{\psi}~\to~\bar{\psi}' = \bar{\psi} e^{-i\frac{\pi}{2}\gamma_5 \frac{T}{2}}, \quad \\
T = {\textrm{diag}}(\eta_u,\eta_d,\eta_s,\eta_c),
\end{gather}
with $\alpha_i\equiv\frac{\pi}{2}\eta_i$ the so called twist angles, defined by
\begin{equation}
{\textrm{cot}}\;\alpha_i=\frac{m_i^{\textrm{R}}}{\mu_i^{\textrm{R}}},
\end{equation}
one retrieves the usual physical (standard) formulation with real fermionic mass
\begin{equation}
M_i^2=m_i^2+\mu_i^2,
\end{equation}
and a chirally rotated Wilson term. The rotated fields $\psi',\bar{\psi}'$ define the so called physical basis, while the unrotated ones $\psi,\bar{\psi}$ define the twisted basis.

In practice we will be working with Wilson tm fermions at full twist
\begin{equation}
\eta_u=\eta_c=-\eta_s=-\eta_d=1,
\end{equation}
which can be obtained by setting the renormalized standard masses $m_i^{\textrm{R}}$ to zero. The procedure to achieve this is explained in Sec.~\ref{ch_ma:sec:matching}.

Considering for simplicity the light sector of mass-degenerate $u$ and $d$ quarks, at full twist the symmetry group $SU(2)_V\times SU(2)_A$ is broken into
\begin{equation}
SU(2)_V\times SU(2)_A\rightarrow[U(1)_A]_1\times[U(1)_A]_2\times[U(1)_V]_3,
\end{equation}
with 
\begin{align}
[U(1)_A]_a=\left\{\begin{matrix}
\psi(x)\rightarrow e^{i\alpha_A^a\gamma_5\frac{\tau^a}{2}}\psi(x) & a=1,2 \\ 
\bar{\psi}(x)\rightarrow \bar{\psi}(x)e^{i\alpha_A^a\gamma_5\frac{\tau^a}{2}} & a=1,2
\end{matrix}\right.,
\end{align}
and
\begin{equation}
[U(1)_V]_3=\left\{\begin{matrix}
\psi(x)\rightarrow e^{i\alpha_A^3\frac{\tau^3}{2}}\psi(x) \\ 
\bar{\psi}(x)\rightarrow \bar{\psi}(x)e^{-i\alpha_A^3\frac{\tau^3}{2}}
\end{matrix}\right.,
\end{equation}
with $\tau^{a}$ the Pauli matrices. This means that at full twist axial symmetries are not completely broken, and thus the twisted mass is protected against additive renormalization,
\begin{equation}
\label{ch_foundation:eq:muR}
\mu_i^{\textrm{R}}=Z_{\mu}(g_0^2,a\mu)\mu_i.
\end{equation}

An important role in our setup is played by the Ward-Takahashi identities (WTI). They will be used to tune the Wilson twisted mass parameters to ensure full twist and to determine the quark masses in the Wilson regularization. Furthermore, they allow to identify the renormalization constant of the twist masses $Z_{\mu}$. For the non-singlet case ($i\neq j$) the WTI for the axial and vector currents, in the continuum limit and in the twisted basis, are as follows (see eqs.~(\ref{ch_observables:eq:bilinears}) for the definition of the currents)
\begin{align}
\label{ch_foundation:eq:WTI}
\partial_{\mu}V_{\mu}^{ij}&=(m_i-m_j)S^{ij}+i(\eta_i\mu_i-\eta_j\mu_j)P^{ij},\\
\partial_{\mu}A_{\mu}^{ij}&=(m_i+m_j)P^{ij}+i(\eta_i\mu_i+\eta_j\mu_j)S^{ij}.
\end{align}
Note that at zero twist angle $\eta_u=\eta_d=\eta_s=\eta_c=0$ the twisted and physical basis are the same, and the standard WTIs are recovered. However, at full twist the renormalized standard masses $m_i^{\textrm{R}}$ vanish, which in turn means that the current masses $m_{i}$ in eqs.~(\ref{ch_foundation:eq:WTI}) also vanish (up to cutoff effects). Moreover, the exact flavor symmetry of massless Wilson fermions implies the existence of a point-split vector current $\tilde{V}_{\mu}^{ij}$ on the lattice such that the vector WTI holds exactly on the lattice. In the twisted basis, this current takes the form
\begin{equation}
\tilde{V}_{\mu}^{ij}=\frac{1}{2}\left[\bar{\psi}^i(x)(\gamma_{\mu}-1)U_{\mu}(x)\psi^j(x+\hat{\mu})+\bar{\psi}^i(x+\hat{\mu})(\gamma_{\mu}+1)U_{\mu}^{\dagger}(x)\psi^j(x)\right].
\end{equation}
The conservation of this WTI on the lattice for $\tilde{V}_{\mu}^{ij}$ means that the point-split vector current renormalizes trivially with
\begin{equation}
\label{ch_foundation:eq:ZV=1}
Z_{\tilde{V}}=1.
\end{equation}
Looking at eq.~(\ref{ch_foundation:eq:WTI}) this means that for all flavors
\begin{equation}
\label{ch_foundation:eq:Zmu}
Z_{\mu}=Z_P^{-1}.
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Path integral regularization}
\label{ch_foundation:sec:path}

Having formulated the QCD action in the lattice, we need to see how physical quantities are computed. To do so, we review some aspects of the path integral formulation in Euclidean spacetime. In this formalism, physical quantities are expressed as expectation values of operators
\begin{align}
\left<{O}(x_1,...,x_n)\right>&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[\psi,\bar{\psi},U]{O}(x_1,...,x_n)e^{-S[\psi,\bar{\psi},U]}, \\
\mathcal{Z}&=\int\mathcal{D}[\psi,\bar{\psi},U]e^{-S[\psi,\bar{\psi},U]}.
\end{align}
This is equivalent to expectation values in statistical mechanics with a Boltzmann factor of $e^{-S[\psi,\bar{\psi},U]}$. The action can be decomposed into its gluon and fermion components $S[\psi,\bar{\psi},U]=S_{\textrm G}[U]+S_{\textrm F}[\psi,\bar{\psi}]$, and fermion variables can be integrated out as
\begin{align}
\left<{O}(x_1,...,x_n)\right>&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]}\mathcal{Z}_{\textrm F}\times\\&\left[\frac{1}{\mathcal{Z}_{\textrm F}}\int\mathcal{D}[\psi,\bar{\psi}]{O}(x_1,...,x_n)e^{-S_{\textrm F}[\psi,\bar{\psi}]}\right] \\
&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]}\mathcal{Z}_{\textrm F}\left<{O}(x_1,...,x_n)\right>_{\textrm F}, \\
\mathcal{Z}_{\textrm F}&=\int\mathcal{D}[\psi,\bar{\psi}]e^{-S_{\textrm F}[\psi,\bar{\psi}]}=\Pi_{i=1}^{N_f}{\textrm{det}}\left(D\right),
\end{align}
This fermionic determinant can be expressed as an effective action as
\begin{align}
\left<{O}(x_1,...,x_n)\right>&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}\left<{O}(x_1,...,x_n)\right>_{\textrm F}, \\
\mathcal{Z}&=\int\mathcal{D}[U]e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}, \\
S_{\textrm{eff}}[U]&=-\sum_{i=1}^{N_f}{\textrm{log}}\;{\textrm{det}}\left(D\right).
\end{align}

In order to compute meson observables we will use meson interpolators, which are composite fermionic observables that share the same quantum numbers as the desired meson state. A generic meson interpolator has the form
\begin{equation}
{O}_A^{ij}(x)=\bar{\psi}^i(x)\Gamma_A\psi^j(x),
\end{equation}	
with $\Gamma_A$ a Gamma matrix. This way, a meson two-point function reads
\begin{align}
\label{ch_foundation:eq:path_int}
\left<{O}_A^{ij}(x_1){O}_B^{ji}(x_2)\right>&=\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}\times\\&\left<\bar{\psi}^i(x_1)\Gamma_A\psi^j(x_1)\psi^i(x_2)\Gamma_B\bar{\psi}^j(x_2)\right>_{\textrm F} \\
&=-\frac{1}{\mathcal{Z}}\int\mathcal{D}[U]e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}\times\\&{\textrm{tr}}\left(\Gamma_AD_i^{-1}(x_1,x_2)\Gamma_BD_j^{-1}(x_2,x_1)\right),
\end{align}
where the trace is over spin indices and $D_i$ the massive Dirac operator for flavor $i$. In order to perform this integral numerically, using the connection with statistical mechanics, a finite set of $N_{\textrm{cnfg}}$ gauge configurations is generated with Boltzmann distribution $e^{-S_{\textrm G}[U]-S_{\textrm{eff}}[U]}$ following a Markov process (see Appendices~\ref{appex_simulations},~\ref{appex_errors}). Then, measurements of the quantity
\begin{equation}
P=-{\textrm{tr}}\left(\Gamma D_i^{-1}(x_1,x_2)\Gamma D_j^{-1}(x_2,x_1)\right),
\end{equation}
are taken in each of these configurations, and the expectation value is computed as
\begin{equation}
\left<P\right>=\frac{1}{N_{\textrm{cnfg}}}\sum_{i}^{N_{\textrm{cnfg}}}P_i+\mathcal{O}\left(\frac{1}{\sqrt{N_{\textrm{cnfg}}}}\right).
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Continuum limit}
\label{ch_foundation:sec:continuum-limit}

The lattice regularization provides a natural energy cutoff $a^{-1}$, ensuring that any loop integral is finite in perturbation theory. In perturbative renormalization, it is necessary to take the cutoff to infinity, which in the lattice means taking the lattice spacing to $a\rightarrow0$. If the theory is renormalizable, any physical quantity (e.g. a mass $m_{\textrm{phys}}$) in units of the lattice spacing must vanish in the continuum limit
\begin{equation}
\label{ch_foundation:eq:ma0}
m_{\textrm{phys}}a\rightarrow0,
\end{equation}
since this means that $m_{\textrm{phys}}$ remains finite in this limit. 

Physical quantities are dependent on the couplings of the theory, $m_{\textrm{phys}}(g_0)$, and accordingly change with them. In turn, one can study how the couplings of the theory change in the lattice as one approaches the continuum limit by decreasing $a$. To do so and for simplicity, we assume a single coupling $g_0$, and write the most general local effective action at lattice spacing $a_1$
\begin{equation}
S(a_1)=g_0(a_1)\sum_i{O}_i,
\end{equation}
where ${O}_i$ are all possible local operators respecting the lattice symmetries. When the lattice spacing is reduced to $a_2<a_1$, all the short-range extra degrees of freedom can be integrated out and reabsorbed into a redefinition of the coupling, such that the new action has the same generic form but with different couplings
\begin{equation}
g_0(a_1)\rightarrow R(g_0(a_1))=g_0(a_2).
\end{equation}
$R$ here stands for the renormalization group (RG) transformation that defines the change in the couplings when varying the lattice spacing.

Since physical quantities change with the couplings, they also do with the lattice spacing, and we want to ensure eq.~(\ref{ch_foundation:eq:ma0}) to ensure renormalizability. It can be observed then that renormalizability corresponds to fixed points $g_0^*$ of the RG transformation
\begin{equation}
R(g_0^*)=g_0^*.
\end{equation}

In the context of SU(N) Yang-Mills theory, perturbation theory shows that at a fixed value of the renormalized coupling $g_R$ the bare coupling runs with the lattice spacing as
\begin{equation}
\label{ch_foundation:eq:beta-func}
a\frac{\partial g_0}{\partial a}\equiv\beta(g_0)=-\beta_0g_0^3-\beta_1g_0^5+...,
\end{equation}
where $\beta_{0,1}$ are universal coefficients (do not depend on the renormalization scheme) and positive for $N=3$ colors and $N_f=6$ flavors, as in the case of QCD. This shows that $g_0=0$ is a fixed point of the RG transformations and thus corresponds to the continuum limit. As the fixed point is in the weak coupling regime, this perturbative argument is expected to be valid. Therefore the continuum limit corresponds to
\begin{equation}
g_0\rightarrow0,
\end{equation}
or in terms of the inverse coupling $\beta$
\begin{equation}
\beta\rightarrow\infty.
\end{equation}

In practice, one cannot numerically simulate at infinite inverse coupling $\beta$. Therefore, physical observables are computed at several finite values of $\beta$. This introduces $\mathcal{O}(a^n)$ cutoff effects in the results, with some power $n$. To obtain results in the continuum, one parameterizes these cutoff effects with some function of the lattice spacing and extrapolates to $a\rightarrow 0$. However, this task is far from trivial~\citep{Husung:2022kvi}. To help in the continuum limit extrapolation, one can systematically reduce lattice artifacts, e.g. from $\mathcal{O}(a)$ to $\mathcal{O}(a^2)$ following the Symanzik improvement program. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Symanzik improvement program}
\label{ch_foundation:sec:impr}

Symanzik improvement requires improving both the action of the theory and the lattice interpolators that enter the different correlators. 

In order to improve a lattice action, one can describe the target continuum action in terms of an effective action in powers of the lattice spacing $a$
\begin{equation}
S_{\textrm{eff}}=\int d^4x\sum_kc_k\mathcal{L}_k(x)a^{k-4}.
\end{equation}
Here $\mathcal{L}_0(x)$ is the discretized lattice Lagrangian unimproved, and the higher-dimension terms $\mathcal{L}_k$(x) are all possible Lagrangians built from fermion and gluon field operators that preserve the symmetries of the regularized theory, i.e. the lattice theory, with mass dimension $4+k$, and $c_k$ are numerical coefficients.

In the case of Lattice QCD, we saw that in the Wilson gauge action in eq.~(\ref{ch_foundation:eq:YM-latt}) lattice artifacts appear at $\mathcal{O}(a^2)$, and therefore no $\mathcal{O}(a)$ improvement is required. However, these $\mathcal{O}(a^2)$ effects can be further reduced by adding all possible dimension $4+k=6$ operators that preserve the underlying symmetries of the gauge action. These dimension-6 operators are all three possible ways of writing a closed path in a rectangular lattice with 6 gauge links: planar, twisted and L-shaped rectangles. The action then reads
\begin{equation}
\label{ch_foundation:eq:SG_impr}
S_G=\frac{\beta}{3}\sum_{\mu\nu}\left[c_0\sum_p{\textrm{Re}}\left({\textrm{tr}}\left(1-U_{\mu\nu}(p)\right)\right)+\sum_{i=1}^3c_i\sum_r{\textrm{Re}}\left({\textrm{tr}}\left(1-U^{(i)}(r)\right)\right)\right],
\end{equation}
with $U^{(i)}$ said dimension-6 operators. Tuning the coefficients $c_i$ properly leads to $\mathcal{O}(a^2)$ improvement. In our study, the CLS ensembles we employ (see Sec.~\ref{ch_ma:sec:Sea}) use the so called Lüscher-Weisz gauge action~\citep{Luscher:1984xn},\citep{Luscher:1985zq}, with these coefficients computed at tree-level
\begin{gather}
\label{ch_foundation:eq:LW}
c_0=\frac{5}{3}, \quad
c_1=-\frac{1}{12}, \quad
c_2=c_3=0.
\end{gather}
Thus, in the Lüscher-Weisz gauge action the only dimension-6 operators that survive are planar rectangles $U^{(1)}$.

We also need to improve the fermion action. Wilson fermions have $\mathcal{O}(a)$ cutoff effects. In order to improve the Wilson fermion action to $\mathcal{O}(a^2)$ we need to look for all possible operators with dimension $4+k=5$ that preserve the lattice symmetries. These are
\begin{gather}
\mathcal{L}_{k=1}^{(1)}=i\bar{\psi}\sigma_{\mu\nu}\hat{F}_{\mu\nu}\psi,\\
\mathcal{L}_{k=1}^{(2)}=\boldsymbol{m}{\textrm{tr}}\left(\hat{F}_{\mu\nu}(x)\hat{F}_{\mu\nu}(x)\right),\\
\mathcal{L}_{k=1}^{(3)}=\boldsymbol{m}^2\bar{\psi}\psi,
\end{gather}
with
\begin{align}
\label{ch_foundation:eq:dim5-op}
\sigma_{\mu\nu}&=\frac{\left[\gamma_{\mu},\gamma_{\nu}\right]}{2i},\\
\hat{F}_{\mu\nu}(x)&=\frac{-i}{8a^2}\left(Q_{\mu\nu}(x)-Q_{\nu\mu}(x)\right),\\
Q_{\mu\nu}&=U_{\mu\nu}(x)+U_{\nu,-\mu}(x)+U_{-\mu,-\nu}(x)+U_{-\nu,\mu}(x).
\end{align}
$\mathcal{L}_{k=1}^{(1),(2)}$ are already present (up to numerical factors) in the original Wilson fermion action and can therefore be reabsorbed in those terms. The $\mathcal{O}(a)$ improved Wilson Dirac operator appearing in the improved fermion action reads
\begin{equation}
\label{ch_foundation:eq:DW_impr}
D_{\textrm W}+\boldsymbol{m}+c_{\textrm{sw}}a\frac{1}{2}\sum_{\mu<\nu}\sigma_{\mu\nu}\hat{F}_{\mu\nu},
\end{equation}
with $c_{\textrm{sw}}$ the Sheikholeslami-Wohlert coefficient determined non-perturbatively in~\citep{Sheikholeslami:1985ij}.

Improving the lattice action ensures improvement of on-shell quantities such as meson masses. However, if one is interested in matrix elements mediated by some current $\mathcal{J}_{\mu}$, it is also necessary to improve the lattice interpolators that enter into the definition of those currents. In analogy with the improvement of the action, a local operator $O$ is expressed in the Symanzik effective theory as
\begin{equation}
O_{\textrm{eff}}(x)=\sum_ka^kO_k(x).
\end{equation}
Again, $O_k$ are gauge invariant local operators with the right mass dimensions. Following this, a generic n-point function reads
\begin{equation}
\label{ch_foundation:eq:Oimpr}
\left<\Phi\right>=\left<\Phi_0\right>-a\int d^4y\left<\Phi_0\mathcal{L}_1(y)\right>+a\left<\Phi_1\right>+...,
\end{equation}
with 
\begin{align}
\left<\Phi_0\right>&=\left<O_0(x_1)...O_0(x_n)\right>, \\
\left<\Phi_1\right>&=\sum_{i=1}^n\left<O_0(x_1)...O_1(x_i)...O_0(x_n)\right>,
\end{align}
and vacuum expectation values taken in the continuum. The generic form of the $O_k$ operators is a sum over all possible operators $\Psi_k$ with the right mass dimension and that are local and gauge invariant,
\begin{equation}
O_k=\sum_ic_i\Psi_k,
\end{equation}
with $c_i$ some non-perturbatively determined coefficients required to suppress $\mathcal{O}(a^k)$ cutoff effects in the correlation functions. In Sec~\ref{ch_observables} we discuss the details of operator improvement for the case of standard Wilson fermions for the observables of interest.

The $\mathcal{O}(a)$ improved Wilson tm fermion action is analogous to the Wilson case, with the improved Dirac operator given by 
\begin{equation}
D_{\textrm W}+\boldsymbol{m}+i\gamma_5\boldsymbol{\mu}+c_{\textrm{sw}}a\frac{1}{2}\sum_{\mu<\nu}\sigma_{\mu\nu}\hat{F}_{\mu\nu}.
\end{equation}
The advantage of Wilson tm fermions is that at full twist (vanishing renormalized standard quark mass) one achieves automatic $\mathcal{O}(a)$ improvement~\citep{Frezzotti:2003ni},\cite{Shindler:2007vp}. This means that physical quantities are automatically improved without the need of any improvement coefficients for lattice operators. The following argument is based on the original work~\cite{Frezzotti:2003ni} to which we refer for a complete proof.

At full twist, the Wilson tm Dirac operator reads
\begin{equation}
D_{\textrm W}+i\boldsymbol{\mu}\gamma_5.
\end{equation}
Working in the twisted basis, this action in the continuum is invariant under a discrete chiral symmetry 
\begin{equation}
\mathcal{R}_5^{1,2}=\left\{\begin{matrix}
\psi(x)\rightarrow i\gamma_5\tau^{1,2}\psi(x) \\ 
\bar{\psi}(x)\rightarrow \bar{\psi}(x)i\gamma_5\tau^{1,2}
\end{matrix}\right.,
\end{equation}
while $\mathcal{L}_{k=1}^{(1)}$ in eq.~(\ref{ch_foundation:eq:dim5-op}) is not 
\begin{equation}
\mathcal{L}_{k=1}^{(1)}\rightarrow-\mathcal{L}_{k=1}^{(1)}.
\end{equation}
This is key for automatic $\mathcal{O}(a)$ improvement. For correlation functions like eq.~(\ref{ch_foundation:eq:Oimpr}), we have that operators may be even or odd under $\mathcal{R}_5$, $\left<\Phi_0\right>$ and $\left<\Phi_1\right>$ having opposite $\mathcal{R}_5$-chirality
\begin{gather}
\left<\Phi_0\right>\rightarrow\pm\left<\Phi_0\right>, \quad \left<\Phi_1\right>\rightarrow\mp\left<\Phi_1\right>.
\end{gather}
This means that for even $\left<\Phi_0\right>$
\begin{gather}
\left<\Phi_0\right>=\left<\Phi_0\right>,
\quad \left<\Phi_0\mathcal{L}^{(1)}_{k=1}\right>=-\left<\Phi_0\mathcal{L}^{(1)}_{k=1}\right>=0, \quad \\ \left<\Phi_1\right>=-\left<\Phi_1\right>=0,
\end{gather}
and thus even operators are automatically $\mathcal{O}(a)$ improved. On the other hand, for odd operators what we have is
\begin{gather}
\left<\Phi_0\right>=-\left<\Phi_0\right>=0, \quad
\left<\Phi_0\mathcal{L}^{(1)}_{k=1}\right>=\left<\Phi_0\mathcal{L}^{(1)}_{k=1}\right>, \quad \\ \left<\Phi_1\right>=\left<\Phi_1\right>,
\end{gather}
and thus they vanish in the continuum. Summing up, the only tuning required for Wilson tm fermions to achieve $\mathcal{O}(a)$ improvement is to set the bare quark mass $m$ to its critical value $m_{\textrm{cr}}$ in order to obtain full twist.

In our particular case, we will be working with a mixed action setup employing standard Wilson quarks in the sea and fully twisted Wilson tm quarks in the valence (see Sec~\ref{ch_ma}). This means valence observables still get residual $\mathcal{O}(a)$ cutoff effects from the sea sector, and thus improvement is still needed. However, these effects are expected to be $\mathcal{O}(g_0^4)$ in perturbation theory.

Finally, we also need to improve the bare gauge coupling, which at $\mathcal{O}(a)$ reads
\begin{equation}
\tilde{g}_0^2=g_0^2\left(1+ab_g{\textrm{tr}}\left(M_q\right)\right),
\end{equation}
with $b_g$ the improvement coefficient, whose value at one-loop is given in~\citep{Luscher:1996sc}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Scale setting}
\label{ch_foundation:sec:ss}

In the lattice, all physical observables are computed in units of the lattice spacing $a$. Thus, in order to make any prediction, it is necessary to determine $a$ in physical units. This task is called scale setting. It involves the precise determination of a reference observable, called the scale, in physical units, to which any other observable is compared to in order to extract the value of the latter in physical units. As an example, we could use the proton mass $m_{\textrm{proton}}$ as a reference scale, and calculate the ratio of it to a given mass $m_i$
\begin{equation}
R_i=\frac{m_i}{m_{\textrm{proton}}}.
\end{equation}
After computing the continuum limit of $R_i$, we can extract the physical mass $m_i$ as
\begin{equation}
\label{ch_ss:eq:R}
m_i^{\textrm{ph}}=R_i(a=0)\times m_{\textrm{proton}}^{\textrm{exp}}.
\end{equation}
Here, the proton mass is used as a reference scale, and comparing any lattice observable to it allows to extract the latter in physical units, once the continuum limit is performed. This procedure is equivalent to finding the value of the lattice spacing in physical units, since it can be extracted as 
\begin{equation}
a=\frac{(am_{\textrm{proton}})^{\textrm latt}}{m_{\textrm{proton}}^{\textrm{exp}}}.
\end{equation}
From eq.~(\ref{ch_ss:eq:R}) it is clear that when aiming for precise lattice calculations of any physical observable like $m_i$, a reliable and precise scale setting is of the utmost importance. In this example this means being able to determine $m_{\textrm{proton}}$ with high accuracy in the lattice in order to compute the ratios $R_i$, controlling the continuum limit of $R_i$ and having a high precision in $m_{\textrm{proton}}^{\textrm{exp}}$.

Instead of using a phenomenological scale like $m_{\textrm{proton}}$, another choice is to use intermediate scales, like the gradient flow scale $t_0$ introduced in Sec.~\ref{ch_observables:sec:Flow}. This quantity can be computed with very high precision in the lattice while it cannot be measured experimentally. To obtain its physical value, one constructs a dimensionless quantity $(\sqrt{t_0}\Lambda)^{\textrm{latt}}$ with some phenomenological quantity $\Lambda$ in the lattice. After performing the continuum limit, the physical value of $t_0$ can be extracted as
\begin{equation}
\sqrt{t_0^{\textrm{ph}}}=\frac{\left.\begin{matrix}
\left(\sqrt{t_0}\Lambda\right)^{\textrm{latt}}
\end{matrix}\right|_{a=0}}{\Lambda^{\textrm{exp}}}.
\end{equation}
Once the physical value of $t_0$ is found, it can be used as an intermediate scale against which any other quantity $\Lambda'$ in the lattice can be compared in order to extract the latter in physical units. For this purpose, one performs a continuum extrapolation of $\sqrt{t_0}\Lambda'$ and obtains the physical value of $\Lambda'$ as
\begin{equation}
\Lambda^{\textrm{' ph}}=\frac{\left.\begin{matrix}
\left(\sqrt{t_0}\Lambda'\right)^{\textrm{latt}}
\end{matrix}\right|_{a=0}}{\sqrt{t_0^{\textrm{ph}}}}.
\end{equation}
This quantity is already a prediction of the lattice.

In addition to the continuum limit, in the lattice often unphysical quark masses are simulated, since they are computationally cheaper. This means one needs to perform chiral extrapolations/interpolations of lattice observables to reach physical quark masses. Both the chiral-continuum limits are discussed in Sec.~\ref{ch_ss} for the scale setting we perform in this thesis.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
