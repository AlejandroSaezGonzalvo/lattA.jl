using LaTeXStrings

const ensemble = Dict(
    1  => "H101",
    2  => "H102r001",
    3  => "H102r002",
    4  => "H105",
    5  => "H105r005",
    6  => "H400",
    7  => "N202",
    8  => "N203",
    9  => "N200",
    10 => "D200",
    11 => "N300",
    12 => "J303"
)

const ensemble_inv = Dict(
    "H101"     => 1,
    "H102r001" => 2,
    "H102r002" => 3,
    "H105"     => 4,
    "H105r005" => 5,
    "H400"     => 6,
    "N202"     => 7,
    "N203"     => 8,
    "N200"     => 9,
    "D200"     => 10,
    "N300"     => 11,
    "J303"     => 12
)

const ens_db = Dict(
    #"ens_id"=>[L, T, beta, dtr, vrw, trunc_cnfg]
    "H101"     => [32, 96, 3.4, 2, "1.2", [1001,1009]],
    "H102r001" => [32, 96, 3.4, 2, "1.2", [997]],
    "H102r002" => [32, 96, 3.4, 2, "1.2", [1008]],
    "H105"     => [32, 96, 3.4, 2, "1.2", [947, 1042]],
    "H105r005" => [32, 96, 3.4, 1, "1.2", [837]],
    "H400"     => [32, 96, 3.46, 1, "1.2", [505,540]],
    "N202"     => [48, 128, 3.55, 2, "1.2", [899]],
    "N203"     => [48, 128, 3.55, 1, "1.4", [756, 787]],
    "N200"     => [48, 128, 3.55, 1, "1.2", [856, 856] ],
    "D200"     => [64, 128, 3.55, 2, "1.2", [2001]],
    "N300"     => [48, 128, 3.70, 1, "1.2", [1521]],
    "J303"     => [64, 192, 3.70, 2, "1.2", [1073]],
    "J501"     => [64, 192, 3.85, 1, "1.2", [50]]
)

const ens_cnfg = Dict(
    #"ens_id"=>[cnfg_rep_true]
    "H101"     => [1001,1009],
    "H102r001" => [997],
    "H102r002" => [1008],
    "H105"     => [1027,1042],
    "H105r005" => [837],
    "H400"     => [505,540],
    "N202"     => [899],
    "N203"     => [756, 787],
    "N200"     => [856, 856],
    "D200"     => [2001],
    "N300"     => [1521],
    "J303"     => [1073],
    "J501"     => [50]
)

const ens_kappa = Dict(
    #"ens_id"=>kappa_grid
    "H101"     => [0.137250, 0.137276, 0.137300],
    "H102r001" => [0.1372457, 0.1372954, 0.1373451],
    "H102r002" => [0.1372457, 0.1372954, 0.1373451],
    "H105"     => [0.1372613, 0.1372977, 0.1373340],
    "H105r005" => [0.1372613, 0.1372977, 0.1373340],
    "H400"     => [0.137272, 0.137300, 0.137330],
    "N202"     => [0.137287, 0.1372986, 0.137310],
    "N203"     => [0.137285, 0.1373057, 0.137325],
    "N200"     => [0.1372947, 0.137300, 0.1373249],
    "D200"     => [0.1373004, 0.1373132, 0.1373261],
    "E250"     => [],
    "N300"     => [0.137180, 0.137206, 0.137218],
    "N302"     => [],
    "J303"     => [0.1372036, 0.1372118, 0.1372199],
    "J500"     => [],
    "J501"     => [],
)

const ens_mul = Dict(
    #"ens_id"=>mul_grid
    "H101"     => [0.00645, 0.0067, 0.006945],
    "H102r001" => [0.004721, 0.004862, 0.005008],
    "H102r002" => [0.004721, 0.004862, 0.005008],
    "H105"     => [0.002800, 0.002920, 0.003040],
    "H105r005" => [0.002800, 0.002920, 0.003040],
    "H400"     => [0.005746, 0.006000, 0.006260],
    "N202"     => [0.005092, 0.005196, 0.005230],
    "N203"     => [0.003500, 0.003576, 0.003700],
    "N200"     => [0.002318, 0.002390, 0.002461],
    "D200"     => [0.001200, 0.001300],
    "E250"     => [],
    "N300"     => [0.0037, 0.0041, 0.0044],
    "N302"     => [],
    "J303"     => [0.00135, 0.00165],
    "J500"     => [],
    "J501"     => []
)

const ens_mus = Dict(
    #"ens_id"=>mus_grid
    "H101"     => [0.006450, 0.006700, 0.006945],
    "H102r001" => [0.10101, 0.10404, 0.10716],
    "H102r002" => [0.10101, 0.10404, 0.10716],
    "H105"     => [0.013200, 0.013700, 0.014200],
    "H105r005" => [0.013200, 0.013700, 0.014200],
    "H400"     => [0.005746, 0.006000, 0.006260],
    "N202"     => [0.005092, 0.005196, 0.005230],
    "N203"     => [0.008100, 0.008329, 0.008600],
    "N200"     => [0.010330, 0.010650, 0.010969],
    "D200"     => [0.012400, 0.013400],
    "E250"     => [],
    "N300"     => [0.0037, 0.0041, 0.0044],
    "N302"     => [],
    "J303"     => [0.0088, 0.0100],
    "J500"     => [],
    "J501"     => []
)

const ens_up_fpik = Dict(
    #"ens_id"=>guess_up_fpik
    "H101"     => [-2530.6554321621106, 2.0171877597068244, 695.3460200403485, -47.762974774302045],
    "H102r001" => rand(5),
    "H102r002" => rand(5),
    "H105"     => [-3647.023538074299, 2.046070785621718, 0.6043520033790867, 1002.0554194810845, -68.82925290799018],
    "H105r005" => [-3647.023538074299, 2.046070785621718, 0.6043520033790867, 1002.0554194810845, -68.82925290799018],
    "H400"     => rand(5),
    "N202"     => [-22233.687495328664, 0.22642040891206375, 6105.926211468878, -419.20786365258914, 0.20495081663619819],
    "N203"     => [-9263.311810774429, 1.751617396717429, 0.78916340466953, 2544.1576854583373, -174.68557755256472],
    "N200"     => [-5095.566054358192, 2.3961223123684237, 0.7738959028516725, 1399.8970053089897, -96.14603159294727],
    "D200"     => [-5866.644157314255, 2.083830853801691, 0.6171341604590854, 1612.0794555362938, -110.74283227797162],
    "E250"     => rand(5),
    "N300"     => [-336563.7355570638, -24.938101048374175, 92361.50133291856, -6336.572033614731, 0.8711172676752281],
    "N302"     => rand(5),
    "J303"     => [-4908.707329440294, 2.533058974887546, 0.8843296646529072, 1348.1427220247463, -92.56260271229861],
    "J500"     => rand(5),
    "J501"     => rand(5)
)

const ens_up_fpi = Dict(
    #"ens_id"=>guess_up_fpik
    "H101"     => rand(4),
    "H102r001" => rand(4),
    "H102r002" => rand(4),
    "H105"     => rand(4),
    "H105r005" => rand(4),
    "H400"     => rand(4),
    "N202"     => rand(4),
    "N203"     => [-8498.79827112438, 1.4048302884934019, 2334.1128481245196, -160.25957052123982],
    "N200"     => [-599.2045917558307, 1.618889520410722, 164.92407021912692, -11.347507060689868],
    "D200"     => [-16355.939510869772, 0.7529079852699858, 4492.4266749788885, -308.47881486193046],
    "E250"     => rand(4),
    "N300"     => rand(4),
    "N302"     => rand(4),
    "J303"     => [-36489.14277091298, 1.2818976550782581, 10013.95169059516, -687.0477687930072],
    "J500"     => rand(4),
    "J501"     => rand(4)
)

const ens_up_fk = Dict(
    #"ens_id"=>guess_up_fpik
    "H101"     => rand(5),
    "H102r001" => rand(5),
    "H102r002" => rand(5),
    "H105"     => rand(5),
    "H105r005" => rand(5),
    "H400"     => rand(5),
    "N202"     => rand(5),
    "N203"     => [-1882.2554400774482, 0.4567223373598134, 0.5207181007226886, 516.9950177001755, -35.49962606447668],
    "N200"     => [-5103.990267887102, 0.7805134733630938, 0.5101319407744797, 1401.8396187706421, -96.25496141139843],
    "D200"     => [-5868.13541701122, 0.997047743422863, 0.4055527598385303, 1611.8443141192952, -110.68347610751468],
    "E250"     => rand(5),
    "N300"     => rand(5),
    "N302"     => rand(5),
    "J303"     => [-4912.474121209329, 0.6507911187880472, 0.4510260943216855, 1348.4178265204473, -92.53065705315962],
    "J500"     => rand(5),
    "J501"     => rand(5)
)

const ens_obs = Dict(
    #"ens_id"=>[t0,mpi,mk,m12,m13,fpi,fk] approx.
    "H101"     => [2.86, 0.18, 0.18, 0.0092, 0.0092, 0.083, 0.083],
    "H102r001" => [2.88, 0.15, 0.19, 0.0063, 0.0100, 0.078, 0.083],
    "H102r002" => [2.88, 0.15, 0.19, 0.0065, 0.0101, 0.080, 0.086],
    "D200"     => [5.18, 0.065, 0.15, 0.0015, 0.0094, 0.054, 0.064],
    "J501"     => [13.94, 0.066, 0.088, 0.0027, 0.0049, 0.035, 0.037]
)

const beta_ZA = Dict(
    #beta=>ZA
    3.40 => uwreal([0.75642,0.00072], "b=3.40"),
    3.46 => uwreal([0.76169,0.00093], "b=3.46"),
    3.55 => uwreal([0.76979,0.00043], "b=3.55"),
    3.70 => uwreal([0.78378,0.00047], "b=3.70"),
    3.85 => uwreal([0.79667,0.00047], "b=3.85")
)

const beta_ZP = Dict(
    #beta=>ZP
    3.40 => uwreal([0.35121,0.00056], "b=3.40"),
    3.46 => uwreal([0.34941,0.00044], "b=3.46"),
    3.55 => uwreal([0.34767,0.00055], "b=3.55"),
    3.70 => uwreal([0.34732,0.00063], "b=3.70"),
    3.85 => uwreal([0.35014,0.00073], "b=3.85")
)

const beta_bap = Dict(
    #beta=>ZP
    3.40 => uwreal([-0.324,0.017], "b=3.40"),
    3.46 => uwreal([-0.265,0.014], "b=3.46"),
    3.55 => uwreal([-0.196,0.014], "b=3.55"),
    3.70 => uwreal([-0.119,0.014], "b=3.70"),
    3.85 => uwreal([-0.073,0.012], "b=3.85")
)

wpm = Dict(
    #"ens_id"=>[L, beta, dtr, vrw]
    "H101"     => [-1.0, -1.0, 4.0, -1.0],
    "H102r001" => [-1.0, -1.0, 4.0, -1.0],
    "H102r002" => [-1.0, -1.0, 4.0, -1.0],
    "H105"     => [-1.0, -1.0, 4.0, -1.0],
    "H105r005" => [-1.0, -1.0, 4.0, -1.0],
    "H400"     => [-1.0, -1.0, 4.0, -1.0],
    "N202"     => [-1.0, -1.0, 4.0, -1.0],
    "N203"     => [-1.0, -1.0, 4.0, -1.0],
    "N200"     => [-1.0, -1.0, 4.0, -1.0],
    "D200"     => [-1.0, -1.0, 4.0, -1.0],
    "N300"     => [-1.0, -1.0, 4.0, -1.0],
    "J303"     => [-1.0, -1.0, 4.0, -1.0],
    "J501"     => [-1.0, -1.0, 4.0, -1.0]
)

function bAt(beta::Float64)
    return 1 + 0.0472 * (6 / beta)
end

#PDG & FLAG21
const hc = 197.3269804 #MeV fm
const Mpi = uwreal([134.9768,0.0005],"mpi PDG") #MeV
const MK = uwreal([497.611,0.013],"mk PDG") #Mev
const Fpi = uwreal([130.56,0.02],"fpi exp") + uwreal([0.0,0.13],"fpi QED") + uwreal([0.0,0.02],"fpi Vud") #MeV FLAG21
const FK = uwreal([157.2,0.2],"fk exp") + uwreal([0.0,0.2],"fk QED") + uwreal([0.0,0.4],"fk Vud") #MeV FLAG21

#t0 model av model tags
const mods = [L"$[\chi SU(3)][a^2][-]$", 
        L"$[\chi SU(3)][a^2][\beta>3.40]$",
        L"$[\chi SU(3)][a^2][\beta>3.46]$", 
        L"$[\chi SU(3)][a^2][m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2][m_{\pi}<350\;MeV]$", 
        L"$[\chi SU(3)][a^2][m_{\pi}L>3.9]$",
        L"$[\chi SU(3)][a^2][m_{\pi}L>4.1]$", 
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][-]$", 
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.40]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.46]$", 
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}<350\;MeV]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}L>3.9]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}L>4.1]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][-]$", 
        L"$[\chi SU(3)][a^2+a^2\phi_2][\beta>3.40]$", 
        L"$[\chi SU(3)][a^2+a^2\phi_2][\beta>3.46]$", 
        L"$[\chi SU(3)][a^2+a^2\phi_2][m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][m_{\pi}<350\;MeV]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][m_{\pi}L>3.9]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][m_{\pi}L>4.1]$", 
        L"$[Tay][a^2][-]$", 
        L"$[Tay][a^2][\beta>3.40]$", 
        L"$[Tay][a^2][\beta>3.46]$", 
        L"$[Tay][a^2][m_{\pi}<420\;MeV]$", 
        L"$[Tay][a^2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[Tay][a^2][m_{\pi}<350\;MeV]$", 
        L"$[Tay][a^2][m_{\pi}L>3.9]$",
        L"$[Tay][a^2][m_{\pi}L>4.1]$", 
        L"$[Tay4][a^2][-]$", 
        L"$[Tay4][a^2][\beta>3.40]$", 
        L"$[Tay4][a^2][\beta>3.46]$", 
        L"$[Tay4][a^2][m_{\pi}<420\;MeV]$",
        L"$[Tay4][a^2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$", 
        L"$[Tay4][a^2][m_{\pi}<350\;MeV]$", 
        L"$[Tay4][a^2][m_{\pi}L>3.9]$",
        L"$[Tay4][a^2][m_{\pi}L>4.1]$", 
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][-]$", 
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.40]$", 
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.46]$", 
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}<420\;MeV]$",
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}<350\;MeV]$",
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}L>3.9]$",
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}L>4.1]$", 
        L"$[Tay][a^2+a^2\phi_2][-]$", 
        L"$[Tay][a^2+a^2\phi_2][\beta>3.40]$", 
        L"$[Tay][a^2+a^2\phi_2][\beta>3.46]$", 
        L"$[Tay][a^2+a^2\phi_2][m_{\pi}<420\;MeV]$",
        L"$[Tay][a^2+a^2\phi_2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[Tay][a^2+a^2\phi_2][m_{\pi}<350\;MeV]$",
        L"$[Tay][a^2+a^2\phi_2][m_{\pi}L>3.9]$",
        L"$[Tay][a^2+a^2\phi_2][m_{\pi}L>4.1]$",
        L"$[\chi SU(2)][a^2][-]$", 
        L"$[\chi SU(2)][a^2][\beta>3.40]$",
        L"$[\chi SU(2)][a^2][\beta>3.46]$", 
        L"$[\chi SU(2)][a^2][m_{\pi}<420\;MeV]$",
        L"$[\chi SU(2)][a^2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[\chi SU(2)][a^2][m_{\pi}<350\;MeV]$", 
        L"$[\chi SU(2)][a^2][m_{\pi}L>3.9]$",
        L"$[\chi SU(2)][a^2][m_{\pi}L>4.1]$"]

const mods_346 = [L"$[\chi SU(3)][a^2][-]$", 
        #L"$[\chi SU(3)][a^2][\beta>3.40]$",
        L"$[\chi SU(3)][a^2][\beta>3.46]$", 
        L"$[\chi SU(3)][a^2][m_{\pi}<420\;MeV]$",
        #L"$[\chi SU(3)][a^2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2][m_{\pi}<350\;MeV]$", 
        L"$[\chi SU(3)][a^2][m_{\pi}L>3.9]$",
        L"$[\chi SU(3)][a^2][m_{\pi}L>4.1]$", 
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][-]$", 
        #L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.40]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.46]$", 
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}<420\;MeV]$",
        #L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}<350\;MeV]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}L>3.9]$",
        L"$[\chi SU(3)][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}L>4.1]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][-]$", 
        #L"$[\chi SU(3)][a^2+a^2\phi_2][\beta>3.40]$", 
        L"$[\chi SU(3)][a^2+a^2\phi_2][\beta>3.46]$", 
        L"$[\chi SU(3)][a^2+a^2\phi_2][m_{\pi}<420\;MeV]$",
        #L"$[\chi SU(3)][a^2+a^2\phi_2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][m_{\pi}<350\;MeV]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][m_{\pi}L>3.9]$",
        L"$[\chi SU(3)][a^2+a^2\phi_2][m_{\pi}L>4.1]$", 
        L"$[Tay][a^2][-]$", 
        #L"$[Tay][a^2][\beta>3.40]$", 
        L"$[Tay][a^2][\beta>3.46]$", 
        L"$[Tay][a^2][m_{\pi}<420\;MeV]$", 
        #L"$[Tay][a^2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[Tay][a^2][m_{\pi}<350\;MeV]$", 
        L"$[Tay][a^2][m_{\pi}L>3.9]$",
        L"$[Tay][a^2][m_{\pi}L>4.1]$", 
        L"$[Tay4][a^2][-]$", 
        #L"$[Tay4][a^2][\beta>3.40]$", 
        L"$[Tay4][a^2][\beta>3.46]$", 
        L"$[Tay4][a^2][m_{\pi}<420\;MeV]$",
        #L"$[Tay4][a^2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$", 
        L"$[Tay4][a^2][m_{\pi}<350\;MeV]$", 
        L"$[Tay4][a^2][m_{\pi}L>3.9]$",
        L"$[Tay4][a^2][m_{\pi}L>4.1]$", 
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][-]$", 
        #L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.40]$", 
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.46]$", 
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}<420\;MeV]$",
        #L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}<350\;MeV]$",
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}L>3.9]$",
        L"$[Tay][a^2\alpha_s^{\hat{\Gamma}}][m_{\pi}L>4.1]$", 
        L"$[Tay][a^2+a^2\phi_2][-]$", 
        #L"$[Tay][a^2+a^2\phi_2][\beta>3.40]$", 
        L"$[Tay][a^2+a^2\phi_2][\beta>3.46]$", 
        L"$[Tay][a^2+a^2\phi_2][m_{\pi}<420\;MeV]$",
        #L"$[Tay][a^2+a^2\phi_2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[Tay][a^2+a^2\phi_2][m_{\pi}<350\;MeV]$",
        L"$[Tay][a^2+a^2\phi_2][m_{\pi}L>3.9]$",
        L"$[Tay][a^2+a^2\phi_2][m_{\pi}L>4.1]$",
        L"$[\chi SU(2)][a^2][-]$", 
        #L"$[\chi SU(2)][a^2][\beta>3.40]$",
        L"$[\chi SU(2)][a^2][\beta>3.46]$", 
        L"$[\chi SU(2)][a^2][m_{\pi}<420\;MeV]$",
        #L"$[\chi SU(2)][a^2][\beta>3.40\;&\;m_{\pi}<420\;MeV]$",
        L"$[\chi SU(2)][a^2][m_{\pi}<350\;MeV]$", 
        L"$[\chi SU(2)][a^2][m_{\pi}L>3.9]$",
        L"$[\chi SU(2)][a^2][m_{\pi}L>4.1]$"]
